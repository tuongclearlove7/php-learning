"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2662],{70749:function(e,n,t){t.d(n,{l:function(){return f}});var r=t(52322);t(2784);var i=t(25460),a=t(45135),s=t(91111),u=t(55965),l=t(49667),o=t(68663),c=t(14307),d=t(35179);let m=()=>{let{routes:e}=(0,o.H)();return(0,r.jsx)(d.YE,{children:(0,r.jsxs)(d.pC,{children:[(0,r.jsx)(d.R6,{text:"Overview",link:e.adminOverview({}),icon:c.TU}),(0,r.jsx)(d.R6,{text:"Users",link:e.adminUsers({}),icon:c.n5}),(0,r.jsx)(d.R6,{text:"Teams",link:e.adminTeams({}),icon:c.Q}),(0,r.jsx)(d.R6,{text:"Projects",link:e.adminProjects({}),icon:c.xu}),(0,r.jsx)(d.R6,{text:"Services",link:e.adminServices({}),icon:c.ZJ}),(0,r.jsx)(d.R6,{text:"Deployments",link:e.adminDeployments({}),icon:c.it}),(0,r.jsx)(d.R6,{text:"Top",link:e.adminTop({}),icon:c.kl}),(0,r.jsx)(d.R6,{text:"Control Panel",link:e.adminControlPanel({}),icon:c.mY})]})})},f=e=>{let{header:n,htmlTitle:t,children:o}=e;return(0,r.jsx)(l.X,{seo:{title:null!=n?"".concat(null!=t?t:n," | Admin"):"Admin"},children:(0,r.jsxs)(a.X,{children:[(0,r.jsx)(m,{}),(0,r.jsxs)(u.M,{children:[null!=n&&(0,r.jsx)(i.XJ,{className:"w-full pb-4 md:pb-4",children:n}),(0,r.jsx)(s.I,{children:o})]})]})})}},45135:function(e,n,t){t.d(n,{X:function(){return s}});var r=t(92228),i=t(77967);function a(){let e=(0,r.Z)(["\n  mt-12 mb-24\n  block space-y-4\n  md:flex md:space-x-12 md:space-y-0\n"]);return a=function(){return e},e}let s=i.dy.div(a())},91111:function(e,n,t){t.d(n,{I:function(){return s}});var r=t(92228),i=t(77967);function a(){let e=(0,r.Z)(["\n  flex flex-col flex-grow w-full first:mt-0 last:mb-0\n"]);return a=function(){return e},e}let s=i.dy.section(a())},55965:function(e,n,t){t.d(n,{M:function(){return s}});var r=t(92228),i=t(77967);function a(){let e=(0,r.Z)(["\n  flex flex-col items-center w-full min-w-0 min-h-lg pt-3\n"]);return a=function(){return e},e}let s=i.dy.main(a())},35179:function(e,n,t){t.d(n,{YE:function(){return x},R6:function(){return v},pC:function(){return w}});var r=t(92228),i=t(52322),a=t(38532),s=t(2784),u=t(77967);let l={list:{visible:{transition:{staggerChildren:.05}}},item:{hidden:{x:-10,opacity:0},visible:{x:0,opacity:1}}};var o=t(68663),c=t(4452),d=t(57507),m=t(48212);t(18345);var f=t(25460);let v=e=>{let{text:n,link:t,active:r,icon:a,highlightSubPath:l}=e,[m,v,g]=(0,c.P)({rotate:35}),{pathname:y}=(0,o.H)(),x=(0,s.useMemo)(()=>null!=r?r:l?y.startsWith(t.url):y===t.url,[r,y,t.url,l]);return(0,i.jsxs)(p,{active:x,...t,scroll:!1,className:"sidebar-item sidebar-item-".concat(n.replace(/\s+/g,"-")," group mb-2 space-x-4 mx-1"),onMouseEnter:g,children:[null!=a&&(0,i.jsx)(d.JO,{icon:a,initial:{rotate:0},animate:m,transition:v,className:(0,u.AK)(x?"text-pink-500":"text-gray-400","group-hover:text-foreground")}),(0,i.jsx)(f.xv,{children:n})]})},p=(0,u.Lq)(m.r)(e=>["relative flex items-center md:px-3 py-2 rounded text-gray-500",e.active&&"text-foreground","md:hover:bg-gray-100 hover:text-foreground"]);function g(){let e=(0,r.Z)(["pt-0 mb-6"]);return g=function(){return e},e}function y(){let e=(0,r.Z)(["\n  w-full pt-4 md:w-sidebar md:min-w-sidebar\n  md:sticky md:top-4 h-max\n"]);return y=function(){return e},e}let x=e=>{let{children:n,...t}=e;return(0,i.jsx)(b,{className:"sidebar",...t,children:n})},w=e=>{let{children:n,shouldAnimate:t,...r}=e;return(0,i.jsx)(h,{initial:t?"hidden":"visible",animate:"visible",variants:l.list,...r,children:n})},h=(0,u.Lq)(a.E.div)(g()),b=u.dy.aside(y())},93327:function(e,n,t){t.d(n,{ej:function(){return P},kN:function(){return h},_1:function(){return A},oT:function(){return x},MD:function(){return f},JD:function(){return p},Vo:function(){return I},yt:function(){return w},zP:function(){return j},uH:function(){return b},Jr:function(){return m},_f:function(){return y},_L:function(){return S},Rm:function(){return g},KZ:function(){return k},Wy:function(){return T},Bh:function(){return v}});var r=t(82066),i=t(79089),a=t(79583),s=t(63798),u=t(16231),l=t(8560),o=t(2784),c=t(88082);let d=e=>{var n,t,r;let{queryKey:i,args:a,queryFn:u,queryConfig:l,itemsPerPage:d=15}=e,[m,f]=(0,c.n)({cursor:void 0,page:0}),{cursor:v,page:p}=m,[g,y]=(0,o.useState)("next"),x=()=>"previous"===g?{last:d,...void 0!==m.cursor&&m.cursor?{before:m.cursor}:{}}:{first:d,...void 0!==m.cursor&&m.cursor?{after:m.cursor}:{}},[w,h]=o.useState(x()),{result:b,...P}=(0,s.o)([...i,w],u({...w,...a}),l);(0,o.useEffect)(()=>{h(x())},[p,v,g,d]);let j=(e,n)=>{f({page:e,cursor:n})};(0,o.useEffect)(()=>{0===m.page&&j(0,void 0)},[m.page,m.cursor]);let S=null===(n=b.data)||void 0===n?void 0:n.pageInfo,{startCursor:k,endCursor:I}=null!=S?S:{},T=e=>{switch(e){case 0:y("next"),j(e,void 0);break;case p-1:y("previous"),j(p-1,0===p?void 0:k||void 0);break;case p+1:y("next"),j(p+1,I||void 0);break;default:throw Error("Invalid page")}},A={page:p,setPage:T,hasPreviousPage:null!==(t=null==S?void 0:S.hasPreviousPage)&&void 0!==t&&t,hasNextPage:null!==(r=null==S?void 0:S.hasNextPage)&&void 0!==r&&r};return{pagination:A,...P,result:b,queryKey:i}},m=()=>{let[{user:e}]=(0,a.aF)(),{graphqlClient:n}=(0,u.S)(),{result:t}=(0,s.o)(["admin","stats"],async()=>(0,i.X)((await n.getAdminStats({})).adminStats),{enabled:null!=e});return{stats:t}},f=()=>{let{graphqlClient:e}=(0,u.S)(),n=(0,r.useQueryClient)();return{adminActions:{ban:async t=>{let{input:{userId:r,reason:i}}=t;await e.userBan({input:{userId:r,reason:i}}),n.invalidateQueries(h(r))},unban:async t=>{let{userId:r}=t;await e.userUnban({userId:r}),n.invalidateQueries(h(r))},delete:async t=>{let{userId:r}=t;await e.adminDelete({userId:r}),n.invalidateQueries(h(r))},banTeam:async t=>{await e.teamBan(t),n.invalidateQueries(P(t.id))},unbanTeam:async t=>{await e.teamUnban(t),n.invalidateQueries(P(t.id))},stopTeamResources:async t=>{await e.teamResourcesStop(t),n.invalidateQueries(P(t.id))}}}},v=e=>{let{graphqlClient:n}=(0,u.S)();return(0,s.o)(["admin","topProjects",e],async()=>(0,i.X)(await n.topMetrics(e)).topMetrics,{staleTime:3e5})},p=e=>{let{graphqlClient:n}=(0,u.S)();return d({queryKey:["admin","projects",e],args:e,queryFn:e=>async()=>{let t=await n.adminAllProjects(e);return{projects:(0,i.X)(t).adminAllProjects,pageInfo:t.adminAllProjects.pageInfo}},itemsPerPage:20})},g=e=>{let{graphqlClient:n}=(0,u.S)(),{result:t,pagination:r}=d({queryKey:["admin","users",e],args:e,queryFn:e=>async()=>{let t=await n.users(e);return{users:(0,i.X)(t).users,pageInfo:t.users.pageInfo}},itemsPerPage:20});return{result:t,pagination:r}},y=e=>{let{graphqlClient:n}=(0,u.S)(),{result:t,pagination:r}=d({queryKey:["admin","teams",e],args:e,queryFn:e=>async()=>{let t=await n.teams(e);return{teams:(0,i.X)(t).teams,pageInfo:t.teams.pageInfo}},itemsPerPage:20});return{result:t,pagination:r}},x=e=>{let{graphqlClient:n}=(0,u.S)(),{result:t,pagination:r}=d({queryKey:["admin","deployments",e],args:e,queryFn:e=>async()=>{let t=await n.adminDeployments(e);return{deployments:(0,i.X)(t).adminDeployments,pageInfo:t.adminDeployments.pageInfo}},itemsPerPage:20});return{result:t,pagination:r}},w=e=>{let{graphqlClient:n}=(0,u.S)();return d({queryKey:["admin","services",e],args:e,queryFn:e=>async()=>{let t=await n.adminAllServices(e);return{services:(0,i.X)(t).adminAllServices,pageInfo:t.adminAllServices.pageInfo}},itemsPerPage:20})},h=e=>["admin","user",e],b=e=>{let{graphqlClient:n}=(0,u.S)(),{result:t}=(0,s.o)(h(e.userId),async()=>{let t=(await n.user(e)).user;return(0,i.X)(t)});return{result:t}},P=e=>["admin","user",e],j=e=>{let{graphqlClient:n}=(0,u.S)();return(0,s.o)(P(e.id),async()=>{let t=(await n.team(e)).team;return(0,i.X)(t)})},S=()=>{let{graphqlClient:e}=(0,u.S)(),n=(0,r.useQueryClient)();return{adminActions:{updateRiskLevel:async t=>{let{input:{userId:r,riskLevel:i}}=t;await e.userRiskLevelUpdate({input:{userId:r,riskLevel:i}}),n.invalidateQueries(h(r))}}}},k=e=>{let{graphqlClient:n}=(0,u.S)(),t=["admin","ip-clashes",e.userId],{result:r}=(0,s.o)(t,async()=>(await n.usersWithClashingIP(e)).usersWithClashingIP);return{usersWithClashingIPs:r}},I=()=>{let{graphqlClient:e}=(0,u.S)(),n=(0,r.useQueryClient)();return{adminActions:{resetTwoFactorInfo:async t=>{await e.twoFactorInfoReset(t),n.invalidateQueries(h(t.userId))}}}},T=e=>{let{graphqlClient:n}=(0,u.S)();return(0,s.o)(["admin","githubEvents",e],async()=>(await n.githubEvents({userId:e})).githubEvents)},A=()=>{let{graphqlClient:e}=(0,u.S)(),n=["admin","control-panel"],{result:t}=(0,s.o)(n,async()=>(await e.lockdownStatus()).lockdownStatus),r={toggleSignups:(0,l.D)(n,async n=>(await e.signupsToggle(n)).signupsToggle),toggleAnonProvisions:(0,l.D)(n,async n=>(await e.anonProvisionsToggle(n)).anonProvisionsToggle),toggleAllProvisions:(0,l.D)(n,async n=>(await e.allProvisionsToggle(n)).allProvisionsToggle)};return{lockdownStatus:t,adminControlPanelActions:r}}},88082:function(e,n,t){t.d(n,{n:function(){return l}});var r,i=t(2784),a=t(68663);let s=(e,n)=>{try{if("boolean"==typeof e)return"true"===n;if("number"==typeof e)return parseInt(n)}catch(e){}return n},u=(e,n)=>Object.entries(e).reduce((e,t)=>{var i;let[a,u]=t;return{...e,[a]:null!=n[a]?s(u,null!==(r=null===(i=n[a])||void 0===i?void 0:i.toString())&&void 0!==r?r:""):u}},e),l=e=>{let{pathname:n,navActions:t,query:r}=(0,a.H)(),[s,l]=(0,i.useState)(()=>u(e,r));(0,i.useEffect)(()=>{l(e=>u(e,r))},[r]);let o=e=>{t.replace({url:n,query:{...r,...e}})};return[s,o]}}}]);