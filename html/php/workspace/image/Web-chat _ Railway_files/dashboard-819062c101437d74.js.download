(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8026],{34937:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(78463)}])},95855:function(e,t,r){"use strict";r.d(t,{L:function(){return j}});var l=r(52322),a=r(47039),n=r.n(a),s=r(2784),i=r(8900),o=r(68663),d=r(5326),c=r(57507),u=r(48212),m=r(64648),g=r(25460),h=r(66440),x=r(77967),v=r(37559);let j=e=>{let{project:t,external:r,className:a,...i}=e,{routes:c}=(0,o.H)(),j=(0,s.useMemo)(()=>t.plugins,[t.plugins]),f=t.services.map(e=>e.deployments[0]).filter(e=>null!=e),b=n()(f,e=>new Date(e.createdAt))[0],y=(0,s.useMemo)(()=>j.length+t.services.length,[t]),w=c.project({projectId:t.id}),N=(0,v.l)(null==b?void 0:b.staticUrl);return(0,l.jsxs)("div",{className:(0,x.AK)("min-h-projectItem p-6 rounded-lg bg-secondaryBg dark:bg-gray-100 hover:bg-gray-100 dark:hover:bg-gray-200 relative",a),...i,children:[(0,l.jsx)(u.r,{...w,external:r,name:"Project Card",className:"absolute inset-0",children:(0,l.jsx)("span",{className:"sr-only",children:"View Project"})}),(0,l.jsxs)("div",{className:"project project-".concat(t.name," flex flex-col h-full pointer-events-none relative z-10"),children:[(0,l.jsxs)(m.g,{className:"flex-grow mb-8",children:[(0,l.jsx)(g.h4,{className:"font-medium mb-3",children:t.name}),null!=t.description&&""!==t.description.trim()&&(0,l.jsx)(g.Zb,{children:t.description})]}),0===y?(0,l.jsx)(g.Zb,{children:"empty project"}):y>1?(0,l.jsxs)(g.Zb,{children:[y," ",(0,d._6)("service",y)]}):null!=b?(0,l.jsxs)(m.U,{align:"center",space:2,children:[(0,l.jsx)(h.g,{status:b.status}),(0,l.jsx)("div",{className:"block text-sm text-gray-600 truncate overflow-hidden overflow-ellipsis pointer-events-auto",children:N?b.staticUrl:(0,l.jsx)(u.r,{href:"https://".concat(b.staticUrl),variant:"highlight",name:"Project Card Static URL",children:b.staticUrl})})]}):null!=j[0]?(0,l.jsx)(p,{pluginType:j[0].name,pluginId:j[0].id,projectId:t.id}):null]})]})},p=e=>{let{pluginType:t,pluginId:r,projectId:a}=e,{routes:n}=(0,o.H)(),s=i.Hh[t];return null==s||null==s.icon?null:(0,l.jsxs)(u.r,{variant:"highlight",...n.projectPlugin({projectId:a,pluginId:r}),name:"Project Card Plugin",className:"flex items-center space-x-2 pointer-events-auto text-gray-600",children:[(0,l.jsx)(c.JO,{icon:s.icon}),(0,l.jsx)(g.$2,{children:s.text})]})}},37559:function(e,t,r){"use strict";r.d(t,{l:function(){return a}});var l=r(2784);let a=e=>(0,l.useMemo)(()=>null!=e&&e.startsWith("*."),[e])},90939:function(e,t,r){"use strict";r.d(t,{Bk:function(){return u},lU:function(){return g},t7:function(){return m}});var l=r(2784),a=r(79583),n=r(63798),s=r(81204),i=r(8560),o=r(16231),d=r(40940),c=r(79089);let u=[{value:d.qmS.Admin,text:"Admin"},{value:d.qmS.Member,text:"Member"}],m=e=>{var t,r;let[{user:n}]=(0,a.aF)(),d=(0,s.qi)(),u=(0,a.z1)(),{graphqlClient:m}=(0,o.S)(),g=(0,l.useMemo)(()=>null!=e&&null!==(r=(null!==(t=null==n?void 0:n.teams)&&void 0!==t?t:[]).find(t=>t.id===e))&&void 0!==r?r:null,[null==n?void 0:n.teams,e]),h=(0,i.D)(a.v0,async e=>{if(null==n)throw Error("Cannot create team for no user");let t=(await m.teamCreate({input:e})).teamCreate;return t}),x=(0,i.D)(a.v0,async e=>{null!=n&&null!=g&&(await m.teamUpdate({id:g.id,input:e}),await d.refreshDashboard())}),v=(0,i.D)(a.v0,async()=>{null!=n&&null!=g&&(u({...n,teams:n.teams.filter(e=>e.id!==g.id)}),await m.teamDelete({id:g.id}),d.optimisticallyRemoveTeam(g),await d.refreshDashboard())}),j=(0,i.D)(a.v0,async()=>{null!=n&&null!=g&&(u({...n,teams:n.teams.filter(e=>e.id!==g.id)}),await m.teamLeave({id:g.id}),d.optimisticallyRemoveTeam(g),await d.refreshDashboard())});return{team:g&&(0,c.X)(g),teamActions:{createTeam:h,updateTeam:x,deleteTeam:v,leaveTeam:j}}},g=e=>{var t;let[{user:r}]=(0,a.aF)(),{graphqlClient:s}=(0,o.S)(),d=["team",e,"members"],{result:c,setQuery:u}=(0,n.o)(d,async()=>{if(null==e)throw Error("teamId not defined");return(await s.teamMembers({id:e})).team.members},{enabled:null!=e}),m=(0,l.useMemo)(()=>{var e,l;return null!==(t=null===(e=null===(l=c.data)||void 0===l?void 0:l.find(e=>e.id===(null==r?void 0:r.id)))||void 0===e?void 0:e.role)&&void 0!==t?t:null},[c.data,r]),g=(0,i.D)(d,async t=>{let{userId:l,role:a}=t;null!=r&&null!=e&&null!=c.data&&(u(c.data.map(e=>e.id===l?{...e,role:a}:e)),await s.teamPermissionChange({input:{teamId:e,userId:l,role:a}}))}),h=(0,i.D)(d,async t=>{null!=r&&null!=e&&null!=c.data&&(u(c.data.filter(e=>e.id!==t)),await s.teamUserRemove({id:e,input:{userId:t}}))});return{teamMembers:c,currentRole:m,teamMemberActions:{changeTeamPermission:g,removeUserFromTeam:h}}}},78463:function(e,t,r){"use strict";r.r(t),r.d(t,{USER_ACCOUNT_ID:function(){return O},default:function(){return K}});var l=r(92228),a=r(52322),n=r(85067),s=r(2784),i=r(92762),o=r(73796),d=r(67846),c=r(4735),u=r(57507),m=r(48212),g=r(18345),h=r(64648),x=r(25460),v=r(49667);let j=e=>{let{children:t}=e;return(0,a.jsx)(v.X,{children:t})};var p=r(75868),f=r(95855),b=r(40940),y=r(13235),w=r(81204),N=r(11083),P=r(27728),k=r(68663),A=r(1371),D=r(90939),I=r(14307),C=r(25154),S=r(20737),U=r(79583),M=r(77967),T=r(5326),_=r(10565);function E(){let e=(0,l.Z)(["\n  grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n"]);return E=function(){return e},e}let O="<user>",z=()=>{var e,t,r,l,i,o,u,m,g;let[{user:v}]=(0,U.aF)(),{dashboard:j,teamProjects:f,teamRoles:b}=(0,w.QU)(),P=(0,w.qi)(),{routes:A}=(0,k.H)(),{modalActions:D}=(0,C.o)(),I=(0,s.useMemo)(()=>{var e,t;let r={};return(null!==(t=null===(e=j.data)||void 0===e?void 0:e.projects)&&void 0!==t?t:[]).forEach(e=>r[e.id]={project:e,teamId:O}),Object.entries(f).forEach(e=>{let[t,l]=e;return l.forEach(e=>r[e.id]={project:e,teamId:t})}),r},[null===(e=j.data)||void 0===e?void 0:e.projects,f]),[S,M]=(0,s.useState)(null),[T,E]=(0,s.useState)(null),z=(0,s.useMemo)(()=>{var e;return null==S?null:null!==(e=I[S])&&void 0!==e?e:null},[S,I]),{confirm:K}=(0,y.p)(),[Z,F]=(0,N.f)(),L=async e=>{var t,r;let l=(null!==(r=null===(t=j.data)||void 0===t?void 0:t.teams)&&void 0!==r?r:[]).find(t=>t.id===e);null!=z&&e!=z.teamId&&(E(S),await K({title:"Transfer Project",description:null==l?"Only you will be able to access the project after transferring":"Only members of ".concat(l.name," will have access to the project after transferring"),confirmButtonText:"Transfer"})&&P.transferProject({project:z.project,teamId:e===O?null:e}).catch(e=>F(e.message)),E(null))},H=e=>{M(e.active.id)},R=e=>{var t,r,l;let a=null===(t=e.over)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.current,n=null!==(l=null==a?void 0:a.allowed)&&void 0!==l&&l;n&&null!=e.over&&"string"==typeof e.over.id&&L(e.over.id),M(null)},B=()=>{M(null)},X=(0,s.useMemo)(()=>Object.values(b).filter(e=>"ADMIN"===e).length+1,[b]);return null==v?null:(0,a.jsxs)(h.g,{className:"py-24 flex-grow",children:[null!=Z&&(0,a.jsx)(x.y,{children:Z}),!(0,_.isTermsAgreed)(v.termsAgreedOn)&&(0,a.jsxs)(d.j,{variant:"warning",className:"mb-12",children:["Your account needs to agree to the Terms of Service."," ",(0,a.jsx)(c.Qj,{variant:"underline",onClick:()=>D.openSidePanel((0,a.jsx)(p.n,{})),className:"ml-1",children:"Please agree to the new terms to keep on using Railway"}),"."]}),(0,a.jsx)(h.g,{className:"space-y-12 md:space-y-24",children:(0,a.jsxs)(n.LB,{onDragStart:H,onDragEnd:R,onDragCancel:B,children:[v.teams.map(e=>{var t;return(0,a.jsx)(q,{uid:e.id,name:e.name,avatar:e.avatar,teamId:e.id,subscriptionState:null!==(i=null===(t=e.customer)||void 0===t?void 0:t.state)&&void 0!==i?i:null,projects:f[e.id],dragItem:z,allowClosing:!0,canTransferProject:X>=2&&"ADMIN"===b[e.id],transferringProjectId:null!==(o=null==T?void 0:T.toString())&&void 0!==o?o:null,numProjects:f[e.id]?f[e.id].length:e.projects.length},e.id)}),(0,a.jsx)(q,{name:null!==(u=v.name)&&void 0!==u?u:v.email,uid:v.id,email:v.email,avatar:v.avatar,projects:null===(t=j.data)||void 0===t?void 0:t.projects,allowClosing:v.teams.length>0,dragItem:z,canTransferProject:X>=2,transferringProjectId:null!==(m=null==T?void 0:T.toString())&&void 0!==m?m:null,numProjects:j.data?j.data.projects.length:v.projects.length,shouldGrow:0===v.teams.length,subscriptionState:null!==(g=null===(r=j.data)||void 0===r?void 0:null===(l=r.customer)||void 0===l?void 0:l.state)&&void 0!==g?g:null})]})})]})};var K=z;z.getLayout=j,z.requireAuthentication=!0;let q=e=>{let{uid:t,name:r,email:l,avatar:u,teamId:g,projects:v,allowClosing:j,dragItem:p,canTransferProject:f,transferringProjectId:y,numProjects:w,shouldGrow:N,subscriptionState:P}=e,{routes:C}=(0,k.H)(),[S,U]=(0,i.ZP)("@railway/dashboard/".concat(t),!0),_=!j||S,E=(0,A.TO)(g),{isOver:z,setNodeRef:K}=(0,n.Zj)({id:null!=g?g:O,data:E}),{teamMembers:q,currentRole:R}=(0,D.lU)(g),{members:B,total:X}=(0,s.useMemo)(()=>{if(null==q.data)return{members:null,total:0};if(q.data.length<=5)return{members:q.data,total:q.data.length};let e=q.data.length,t=q.data.sort(()=>Math.random()-.5).slice(0,5);return{members:t,total:e}},[q.data]);return(0,a.jsxs)("div",{ref:K,className:(0,M.AK)("relative flex flex-col",N&&"flex-grow"),children:[null!=p&&p.teamId!==(null!=g?g:O)&&(0,a.jsx)("div",{className:(0,M.AK)("absolute inset-0 z-10","p-4 bg-gray-100 opacity-90"),children:(0,a.jsx)("div",{className:(0,M.AK)("w-full h-full flex items-center justify-center","border-4 rounded",z&&E.allowed?"border-pink-500":"border-gray-300"),children:(0,a.jsx)(x.Wr,{children:E.allowed?(0,a.jsxs)(a.Fragment,{children:["Transfer Project to"," ",(0,a.jsx)("span",{className:"text-pink-500",children:r})]}):(0,a.jsx)(a.Fragment,{children:E.message})})})}),(0,a.jsxs)("div",{className:(0,M.AK)("flex w-full","flex-col items-start space-y-4","sm:flex-row sm:items-center sm:justify-between sm:space-x-4 sm:space-y-0",_&&"mb-8"),children:[(0,a.jsx)("button",{onClick:()=>{j&&U(e=>!e)},className:(0,M.AK)("group","flex items-center justify-between flex-grow m-0 focus:outline-none",j?"cursor-pointer hover:opacity-60":"cursor-default"),children:(0,a.jsxs)(h.U,{align:"center",space:4,children:[(0,a.jsx)(o.q,{name:r,email:l,avatar:u,size:"32px"}),(0,a.jsx)(x.XJ,{children:r})]})}),(0,a.jsxs)(h.U,{align:"center",children:[!_&&null!=v&&(0,a.jsxs)(x.Zb,{className:"hidden md:block mr-6",children:[v.length," ",(0,T._6)("project",v.length)]}),null!=B&&(0,a.jsxs)("div",{className:"flex -space-x-2 mr-6",children:[B.map(e=>(0,a.jsx)(o.q,{email:e.email,avatar:e.avatar,size:"28px",className:"border-background border-2"},e.id)),X>5&&(0,a.jsxs)(h.g,{align:"center",justify:"center",className:"w-7 h-7 rounded-full overflow-hidden text-sm bg-background border-background border-2",children:["+",X-5]})]}),null!=R&&(0,a.jsx)("div",{className:(0,M.AK)("mr-6 px-3 py-1 font-medium text-sm rounded-md",R===b.qmS.Admin?"bg-pink-50 text-pink-500":"bg-green-50 text-green-600"),children:R===b.qmS.Admin?"Owner":"Member"}),(0,a.jsx)(c.x6,{color:"gray",size:"sm",variant:"outline",...C.account({teamId:g}),icon:I.Zr,onClick:e=>e.stopPropagation(),name:"Account Settings",className:"hidden md:flex mr-3 text-gray-600"}),(0,a.jsx)(c.ZP,{icon:I.v3,color:"gray",variant:"outline",size:"sm",iconStyles:"!text-pink-500",...C.newProject({teamId:g}),onClick:e=>e.stopPropagation(),children:"New Project"})]})]}),("UNPAID"===P||"PAST_DUE"===P)&&(0,a.jsxs)(d.j,{variant:"UNPAID"===P?"danger":"warning",className:"mb-8",children:["Your subscription is"," ",(0,T.J4)(P).toLocaleLowerCase(),". Please\xa0",(0,a.jsx)(m.r,{variant:"underline",...C.accountBilling({teamId:g}),children:"update your payment method"}),"."]}),_&&(0,a.jsx)(a.Fragment,{children:0===w?(0,a.jsx)(Z,{teamId:g}):null==v?(0,a.jsx)(L,{numProjects:w}):(0,a.jsx)(H,{children:v.map(e=>(0,a.jsx)(F,{project:e,enableDragging:f,isTransferring:y===e.id},e.id))})})]})},Z=e=>{let{teamId:t}=e,{routes:r}=(0,k.H)(),l=(0,P.t)(),{colorMode:n}=(0,S.Fg)(),s=l?"/illustrations/dashboard-empty-state-".concat("dark"===n?"dark":"light",".svg"):null,i=l?"/illustrations/dashboard-empty-state-circles-".concat("dark"===n?"dark":"light",".svg"):null;return(0,a.jsxs)(m.r,{...r.newProject({teamId:t}),className:(0,M.AK)("group","relative flex flex-col md:flex-row items-center justify-center flex-grow border border-dashed border-gray-200 rounded-lg py-36 h-[444px]","hover:border-pink-500"),children:[null!=s&&null!=i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{alt:"",src:s,style:{width:136,height:136},className:"bg-background z-1 h-max"}),(0,a.jsx)("img",{alt:"",src:i,className:"absolute left-0 top-0 bottom-0 hidden lg:block"})]}):(0,a.jsx)("div",{style:{width:136,height:136}}),(0,a.jsxs)(h.g,{className:"max-w-[380px] mt-8 md:mt-0 md:ml-8 text-center md:text-left",children:[(0,a.jsx)(x.by,{className:"mb-2 text-gray-600 font-medium",children:"Create a New Project"}),(0,a.jsx)(x.$2,{className:"mb-5 text-gray-400",children:"Deploy a GitHub Repository, Provision a Database, or create an Empty Project to start from local."})]})]})},F=e=>{let{project:t,enableDragging:r,isTransferring:l}=e,{attributes:s,listeners:i,setNodeRef:o,transform:d,isDragging:c}=(0,n.O1)({id:t.id}),m=c&&null!=d?{transform:"translate3d(".concat(d.x,"px, ").concat(d.y,"px, 0) scale(1.02)"),zIndex:999999}:void 0;return(0,a.jsxs)("div",{style:m,className:(0,M.AK)("relative focus:outline-none focus:ring focus:ring-blue-500 rounded",!c&&!l&&"transform transition-transform",c&&"cursor-grabbing"),children:[(0,a.jsx)(f.L,{project:t,className:"h-full"}),r&&(0,a.jsx)(u.JO,{ref:o,...i,...s,icon:I.xQ,size:"xs",className:(0,M.AK)("hidden md:block","absolute top-4 right-4 text-gray-300","focus:outline-none hover:text-foreground",c?"!cursor-grabbing":"!cursor-grab")})]})},L=e=>{let{numProjects:t}=e;return(0,a.jsx)(H,{children:Array.from({length:t}).map((e,t)=>(0,a.jsx)(g.B,{width:"100%",height:"100%",className:"h-projectItem"},t))})},H=M.dy.div(E())}},function(e){e.O(0,[5067,565,9774,2888,179],function(){return e(e.s=34937)}),_N_E=e.O()}]);