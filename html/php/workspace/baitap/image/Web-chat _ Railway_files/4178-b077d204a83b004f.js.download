"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4178],{44726:function(e,t,n){n.d(t,{e:function(){return u}});var l=n(52322),r=n(2784),i=n(17250),a=n(14307),s=n(77967),o=n(4735),c=n(57507),d=n(64648);let u=e=>{var t;let{hideCopyButton:n,textToCopy:u,copyButtonStyles:m,children:p,...g}=e,x=(0,r.useMemo)(()=>null!==(t=null==p?void 0:p.toString())&&void 0!==t?t:"",[p]),[h,v]=(0,i.F)(),y=()=>{null!=x&&v("string"==typeof u?u:x)};return(0,l.jsxs)("pre",{...g,className:(0,s.AK)("grid gap-1 grid-cols-[minmax(0px,_1fr)_auto] items-center","relative min-h-[44px] my-0 py-2 px-3 text-sm font-mono rounded-lg leading-6 bg-gray-100 border border-gray-100",g.className),children:[(0,l.jsx)("span",{className:"overflow-hidden overflow-ellipsis",children:p}),!n&&(0,l.jsx)("div",{children:h?(0,l.jsx)(d.g,{align:"center",justify:"center",className:"h-sm py-1.5",children:(0,l.jsx)(c.JO,{icon:a.Jr,size:"sm",initial:{y:6},animate:{y:0}})}):(0,l.jsx)(o.hU,{icon:a.CK,title:"Copy Code",iconStyles:m,onClick:y,type:"button",className:(0,s.AK)("copy-button","m-0 p-0 text-foreground transition-opacity duration-150","hover:bg-gray-200")})})]})}},26662:function(e,t,n){n.d(t,{u:function(){return i}});var l=n(52322),r=n(66276);let i=e=>{let{content:t,open:n,defaultOpen:i,side:a="top",onOpenChange:s,children:o,disabled:c,...d}=e;return c?(0,l.jsx)(l.Fragment,{children:o}):(0,l.jsx)(r.zt,{children:(0,l.jsxs)(r.fC,{open:n,defaultOpen:i,onOpenChange:s,children:[(0,l.jsx)(r.xz,{asChild:!0,className:"cursor-default",children:o}),(0,l.jsxs)(r.VY,{side:a,align:"center",...d,className:"max-w-[16rem] text-sm text-center bg-gray-200 text-foreground rounded py-2 px-3 leading-snug z-10",children:[t,(0,l.jsx)(r.Eh,{width:12,height:6,className:"fill-current text-gray-200"})]})]})})}},14178:function(e,t,n){n.d(t,{u:function(){return eP}});var l=n(52322),r=n(39933),i=n(2784),a=n(40940),s=n(86289),o=n(26330),c=n(67930);let d=e=>{let{actions:t,isLoading:n}=(0,o.v)(e),[{permissions:l}]=(0,c.PY)(),{addCommand:r}=(0,s.xd)();(0,i.useEffect)(()=>{if(!n&&l.Write)return r(...[{value:"remove-deployment",text:"Remove Deployment",group:"Deployment",isAvailable:()=>null!=t.removeDeployment,action:()=>{null!=t.removeDeployment&&t.removeDeployment()}},{value:"cancel-deployment",text:"Cancel Deployment",group:"Deployment",isAvailable:()=>null!=t.cancelDeployment,action:()=>{null!=t.cancelDeployment&&t.cancelDeployment()}},{value:"restart-deployment",text:"Restart Deployment",group:"Deployment",isAvailable:()=>null!=t.restartDeployment,action:()=>{null!=t.restartDeployment&&t.restartDeployment()}},{value:"redeploy-deployment",text:"Redeploy Deployment",group:"Deployment",isAvailable:()=>null!=t.redeployDeployment,action:()=>{null!=t.redeployDeployment&&t.redeployDeployment()}},{value:"rollback-deployment",text:"Rollback Deployment",group:"Deployment",isAvailable:()=>null!=t.rollbackDeployment,action:()=>{null!=t.rollbackDeployment&&t.rollbackDeployment()}}])},[e.status,n,t.removeDeployment,t.cancelDeployment,t.restartDeployment,t.redeployDeployment,t.rollbackDeployment])};var u=n(10715),m=n(60017),p=n(25154);let g=e=>{let[{project:t,environment:n},r]=(0,c.PY)(),{modalActions:a}=(0,p.o)();(0,i.useEffect)(()=>{if(null==e||null==t||null==n||n.id===e)return;let i=t.environments.find(t=>t.id===e);null!=i&&(r.setActiveEnvironment(e),a.createToast((0,l.jsx)(m.FN,{title:"Activated the ".concat(i.name," environment")})))},[e,null==t?void 0:t.id])};var x=n(82102),h=n(65884),v=n(64319),y=n(14351),f=n(14307),b=n(67846),j=n(48212),w=n(21780),N=n(11892),k=n(55443),D=n(18845),S=n(89499);let C=(e,t)=>(0,S.m)(a.$69,e,{...t});var P=n(27873);let F=e=>{var t,n;let{deployment:r,filter:s="",scrollParent:o}=e,c=null!==(t=r.meta)&&void 0!==t?t:{},[{logs:d,noMoreLogs:u,isLoading:m},{loadMore:p}]=(0,P.cS)({filter:s,deploymentId:r.id,limit:D.N,deps:[s,r.id]}),g=C({deploymentId:r.id,filter:s,limit:D.N},{enabled:"INITIALIZING"!==r.status,compare:(e,t)=>t.timestamp>e.timestamp?1:-1,deps:[s,r.id]}),x=(0,i.useMemo)(()=>(0,k.getServiceManifestWarnings)(null!==(n=c.serviceManifest)&&void 0!==n?n:{}),[c.serviceManifest]);return null!=c.configErrors&&c.configErrors.length>0?(0,l.jsx)(w.Mb,{logs:c.configErrors.map(e=>({message:e,timestamp:new Date().toDateString()}))}):null!=c.checkSuitesError&&""!==c.checkSuitesError.trim()?(0,l.jsx)(w.Mb,{logs:[{message:c.checkSuitesError,timestamp:new Date().toDateString()}]}):(0,l.jsx)(w.Mb,{subscription:g,logs:d,pageSize:D.N,loadMore:p,noMoreLogs:u,isLoadingMore:m,stickyScrollParent:o,warnings:x,emptyMessage:r.status===a.Wtj.Initializing?"Waiting for build to start...":""!==s?(0,l.jsxs)(l.Fragment,{children:["No logs found containing ",(0,l.jsx)("strong",{children:s})]}):"No build logs found for deployment"})},A=(e,t)=>(0,S.m)(a.BBv,e,{...t});var M=n(68663);let I=e=>{let{deployment:t,filter:n="",scrollParent:r}=e,{routes:i}=(0,M.H)(),[{logs:s,noMoreLogs:o,isLoading:c},{loadMore:d}]=(0,P.S7)({deploymentId:t.id,filter:n,limit:D.N,deps:[n,t.id]}),u=A({deploymentId:t.id,filter:n,limit:D.N},{enabled:"SUCCESS"===t.status||"REMOVED"===t.status||"CRASHED"===t.status||"DEPLOYING"===t.status||"FAILED"===t.status,compare:(e,t)=>t.timestamp>e.timestamp?1:-1,deps:[n,t.id]}),m=(0,P.Zf)("failed to launch: determine start command",u);return m?(0,l.jsxs)(b.j,{variant:"warning",children:["Your app failed to start because you are missing a Railway start command.",(0,l.jsx)(j.r,{variant:"underline",...i.projectServiceSettings({}),children:"Add one here"}),"."]}):(0,l.jsx)(w.Mb,{subscription:u,logs:s,pageSize:D.N,loadMore:d,noMoreLogs:o,isLoadingMore:c,stickyScrollParent:r,emptyMessage:t.status===a.Wtj.Initializing||t.status===a.Wtj.Building?"Waiting for deploy to finish...":""!==n?(0,l.jsxs)(l.Fragment,{children:["No logs found containing ",(0,l.jsx)("strong",{children:n})]}):"No deployment logs. All output sent to stdout will be displayed here"})};var R=n(92228),E=n(92762),T=n(98937),L=n(77967),z=n(5326),_=n(37160),O=n(57507),B=n(64648),Z=n(25460),U=n(17250),W=n(42580),K=n(30486);let J=e=>null!=e&&""!==e.toString().trim()&&(!Array.isArray(e)||e.length>0),H=(e,t)=>null==t?"":Object.entries(null!=t?t:{}).filter(e=>{let[,t]=e;return J(t)}).reduce((e,t)=>{let[n,l]=t;return"".concat(e,"\n").concat(n," = ").concat(JSON.stringify(l))},"".concat(e)),Q=e=>{let t=H("[build]",null==e?void 0:e.build),n=H("[deploy]",null==e?void 0:e.deploy);return"".concat(t,"\n\n").concat(n)},Y=e=>{let t=Object.entries(null!=e?e:{}).reduce((e,t)=>{let[n,l]=t;return{...e,...null!=l?{[n]:Object.entries(l).filter(e=>{let[,t]=e;return J(t)}).reduce((e,t)=>{let[n,l]=t;return{...e,[n]:l}},{})}:{}}},{});return JSON.stringify({$schema:K.pN,...t},null,2)};var V=n(4735),$=n(44726),q=n(72776);let X=e=>{let{sm:t,meta:n}=e,[r,a]=(0,E.ZP)("@railway/config/code/lang","json"),[s,o]=(0,U.F)(),[c,d]=(0,i.useState)(null),[u,m]=(0,i.useState)(null);return((0,i.useEffect)(()=>{try{m(null);let e="json"===r?Y(t):Q(t);d(e)}catch(e){m(e.message),d(null)}},[t,r]),null==c)?null:(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)(G,{meta:null!=n?n:{},lang:r}),(0,l.jsxs)("div",{className:"relative bg-black dark:bg-white bg-opacity-[2%] dark:bg-opacity-[2%] p-4 mt-4 rounded-md",children:[(0,l.jsxs)("div",{className:(0,L.AK)("grid grid-cols-2","absolute top-4 left-0 right-4 items-center z-10"),children:[null!=u&&(0,l.jsx)(Z.y,{className:"mb-0 py-1",children:u}),(0,l.jsxs)(B.U,{space:3,align:"center",justify:"end",className:"col-start-2",children:[(0,l.jsx)(q.P,{size:"sm",label:{text:"Format",hidden:!0},options:[{value:"json",text:"JSON"},{value:"toml",text:"TOML"}],value:r,onChange:e=>a(e),style:{minWidth:"100px"}}),(0,l.jsx)(V.hU,{icon:s?f.Jr:f.CK,title:"Copy manifest to clipboard",variant:"outline",onClick:()=>o(c)})]})]}),(0,l.jsx)($.e,{hideCopyButton:!0,className:"bg-transparent border-none rounded-none",children:c})]})]})},G=e=>{let{meta:t,lang:n}=e,r=(null==t?void 0:t.configFile)!=null&&(null==t?void 0:t.repo)!=null&&null!=t.branch?(0,W.r)({repo:t.repo,branch:t.branch,path:null!=t.rootDirectory?"".concat(t.rootDirectory,"/").concat(t.configFile):t.configFile}):null,{routes:i}=(0,M.H)();return null==t.configFile?(0,l.jsxs)(b.j,{variant:"info",size:"sm",children:[(0,l.jsx)("div",{className:"w-full flex items-center justify-between",children:(0,l.jsxs)("p",{children:["Save this in a file called"," ",(0,l.jsx)("b",{className:"font-semibold",children:"json"===n?"railway.json":"railway.toml"})," ","to codify your deployments config."]})}),(0,l.jsx)(j.r,{variant:"coloured",...i.docs({page:"/deploy/config-as-code"}),className:"text-sm whitespace-nowrap",children:"Visit Docs ↗"})]}):(0,l.jsxs)("div",{className:"grid items-center gap-2 grid-cols-[auto_1fr_auto] text-sm bg-black dark:bg-white bg-opacity-[2%] dark:bg-opacity-[2%] px-4 py-2 rounded-md",children:[(0,l.jsx)(O.JO,{icon:f.EK,className:"text-gray-500"}),(0,l.jsxs)(Z.$2,{children:["Configuration merged from"," ",(0,l.jsx)(j.r,{...i.projectServiceSettings({}),variant:"coloured",children:"service settings"})," ","and ",(0,l.jsx)("b",{className:"font-semibold",children:t.configFile})]}),null!=r&&(0,l.jsxs)(j.r,{variant:"coloured",href:r,className:"text-sm whitespace-nowrap",children:["Edit ",(0,l.jsx)("b",{className:"font-semibold",children:t.configFile})," in GitHub ↗"]})]})};var ee=n(27728),et=n(34262),en=n(20737),el=n(26662),er=n(58317);let ei=e=>{var t,n,r,a,s,o,c,d,u,m,p,g;let{sm:x,meta:h,propertyFileMapping:v}=e,{colorMode:y}=(0,en.Fg)(),f=(0,ee.t)(),b="light"===(!f||y)?"dark":"light",j=(0,i.useMemo)(()=>{var e,t,n,r;let i=null!==(t=null==h?void 0:h.nixpacksProviders)&&void 0!==t?t:[],a=null!==(n=null==x?void 0:null===(e=x.build)||void 0===e?void 0:e.nixpacksPlan)&&void 0!==n?n:{},s=null!==(r=null==a?void 0:a.providers)&&void 0!==r?r:i,o=s.flatMap(e=>(0,er.Z)(e)?i:e);return 0!==o.length&&f?(0,l.jsx)("div",{className:"flex flex-row items-center space-x-2",children:o.map(e=>(0,l.jsx)("img",{src:"https://devicons.railway.app/".concat(e,"?variant=").concat(b),alt:"",className:"w-6 h-6"},e))}):null},[null==h?void 0:h.nixpacksProviders,null==x?void 0:x.build,f]);return(0,l.jsxs)("div",{className:"grid gap-10 grid-cols-1 md:grid-cols-2",children:[(0,l.jsx)(ea,{title:"Build",items:[{name:"Builder",value:(0,et.b)(null==x?void 0:null===(t=x.build)||void 0===t?void 0:t.builder),path:v["build.builder"],configFile:null==h?void 0:h.configFile,sideElement:(null==x?void 0:null===(n=x.build)||void 0===n?void 0:n.builder)==="NIXPACKS"?j:null},{name:"Build Command",value:null==x?void 0:null===(r=x.build)||void 0===r?void 0:r.buildCommand,path:v["build.buildCommand"],configFile:null==h?void 0:h.configFile},{name:"Dockerfile Path",value:null==x?void 0:null===(a=x.build)||void 0===a?void 0:a.dockerfilePath,path:v["build.dockerfilePath"],configFile:null==h?void 0:h.configFile},{name:"Nixpacks Config Path",value:null==x?void 0:null===(s=x.build)||void 0===s?void 0:s.nixpacksConfigPath,path:v["build.nixpacksConfigPath"],configFile:null==h?void 0:h.configFile},{name:"Watch Patterns",value:null==x?void 0:null===(o=x.build)||void 0===o?void 0:o.watchPatterns,path:v["build.watchPatterns"],configFile:null==h?void 0:h.configFile}]}),(0,l.jsx)(ea,{title:"Deploy",items:[{name:"Start command",value:null==x?void 0:null===(c=x.deploy)||void 0===c?void 0:c.startCommand,path:v["deploy.startCommand"],configFile:null==h?void 0:h.configFile},{name:"Healthcheck Path",value:null==x?void 0:null===(d=x.deploy)||void 0===d?void 0:d.healthcheckPath,path:v["deploy.healthcheckPath"],configFile:null==h?void 0:h.configFile},{name:"Healthcheck Timeout (sec)",value:null==x?void 0:null===(u=x.deploy)||void 0===u?void 0:u.healthcheckTimeout,path:v["deploy.healthcheckTimeout"],configFile:null==h?void 0:h.configFile},{name:"Restart Policy",value:(0,et.b)(null==x?void 0:null===(m=x.deploy)||void 0===m?void 0:m.restartPolicyType),path:v["deploy.restartPolicyType"],configFile:null==h?void 0:h.configFile},{name:"Restart Policy Max Retries",value:(null==x?void 0:null===(p=x.deploy)||void 0===p?void 0:p.restartPolicyType)==="ON_FAILURE"?null==x?void 0:null===(g=x.deploy)||void 0===g?void 0:g.restartPolicyMaxRetries:null,path:v["deploy.restartPolicyMaxRetries"],configFile:null==h?void 0:h.configFile}]})]})},ea=e=>{let{title:t,items:n}=e,r=n.filter(e=>{let{value:t}=e;return J(t)});return(0,l.jsxs)("div",{children:[(0,l.jsx)(Z.$2,{className:"mb-6 font-semibold",children:t}),(0,l.jsx)("div",{className:"grid gap-4",children:r.map((e,t)=>{let{name:n,value:a,path:s,configFile:o,sideElement:c}=e;return(0,l.jsxs)(i.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(Z.OM,{className:"text-gray-600 mb-2",children:n}),(0,l.jsxs)(Z.xv,{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[Array.isArray(a)?(0,l.jsx)("span",{className:"whitespace-pre",children:a.join("\n")}):(0,l.jsx)("span",{children:a}),c]}),null!=s&&null!=o&&(0,l.jsx)(el.u,{side:"bottom",content:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-xs font-mono text-pink-500 dark:text-pink-600 break-all",children:s})," ","in ",o]}),children:(0,l.jsx)(O.JO,{icon:f.ac,className:"text-gray-300"})})]})]}),t!==r.length-1&&(0,l.jsx)(_.i,{className:"!my-0 border-gray-200"})]},n)})})]})};function es(){let e=(0,R.Z)(["\n  flex space-x-4 items-center\n  px-5 py-4 rounded border border-transparent\n  bg-black/[.02] dark:bg-white/[.02]\n"]);return es=function(){return e},e}let eo=e=>{var t,n;let{deployment:r}=e,i=null!==(t=null==r?void 0:r.meta)&&void 0!==t?t:{},a=i.serviceManifest,s=null!==(n=i.propertyFileMapping)&&void 0!==n?n:{};return(0,l.jsx)("div",{className:"h-full grid grid-rows-[minmax(0px,_1fr)] bg-gray-100",children:(0,l.jsxs)("div",{className:"space-y-12 px-5 md:px-12 py-8 overflow-y-auto",children:[(0,l.jsx)(eu,{deployment:r,meta:i}),(0,l.jsx)(ec,{sm:a,meta:i,propertyFileMapping:s})]})})},ec=e=>{let{sm:t,meta:n,propertyFileMapping:i={}}=e,[a,s]=(0,E.ZP)("@railway/config/view","pretty"),{track:o}=(0,T.K)();return(0,l.jsxs)(r.fC,{value:a,onValueChange:e=>{a!==e&&(s(e),o({action:"Click",object:"Deployment ".concat((0,z.kC)(e)," Configuration")}))},children:[(0,l.jsxs)(B.U,{align:"center",justify:"between",children:[(0,l.jsx)(Z.Cd,{children:"Configuration"}),(0,l.jsxs)(r.aV,{className:"grid grid-cols-2",children:[(0,l.jsxs)(ed,{value:"pretty",active:"pretty"===a,children:[(0,l.jsx)(O.JO,{icon:f.aV,className:"code"===a?"!text-gray-600":"!text-gray-400"}),(0,l.jsx)(Z.xv,{children:"Pretty"})]}),(0,l.jsxs)(ed,{value:"code",active:"code"===a,children:[(0,l.jsx)(O.JO,{icon:f.EK,className:"code"===a?"!text-gray-600":"!text-gray-400"}),(0,l.jsx)(Z.xv,{children:"Code"})]})]})]}),(0,l.jsx)(_.i,{className:"my-6 border-gray-200"}),(0,l.jsx)(r.VY,{value:"pretty",children:(0,l.jsx)(ei,{sm:t,meta:n,propertyFileMapping:i})}),(0,l.jsx)(r.VY,{value:"code",children:(0,l.jsx)(X,{sm:t,meta:n})})]})},ed=(0,L.Lq)(r.xz)(e=>{let{active:t}=e;return["flex items-center space-x-3 px-3 py-2 text-gray-500 border cursor-pointer","first:rounded-l-md last:rounded-r-md",t?"text-foreground bg-black dark:bg-white bg-opacity-[2%] dark:bg-opacity-[2%] border-transparent":"border-gray-200 hover:text-foreground"]}),eu=e=>{var t,n,r;let{meta:i,deployment:a}=e,s=null!=i.commitMessage;return(0,l.jsxs)(B.g,{children:[(0,l.jsxs)(Z.Cd,{className:"mb-4",children:["Deployed via ",s?"GitHub":"CLI"]}),s?(0,l.jsx)(j.r,{href:"https://github.com/".concat(i.repo,"/commit/").concat(i.commitHash),className:"flex flex-col col-span-2 group",children:(0,l.jsxs)(em,{className:"group-hover:border-pink-500",children:[(0,l.jsx)(O.JO,{icon:f.Tf,size:"2xl",className:"bg-white dark:bg-black bg-opacity-50 dark:bg-opacity-40 border border-gray-200 p-2 rounded-lg"}),(0,l.jsxs)(B.g,{className:"overflow-hidden",children:[(0,l.jsx)(Z.xv,{className:"mb-1.5 truncate",children:i.commitMessage}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center text-gray-400 space-x-3 md:space-x-6 max-w-full",children:[(0,l.jsx)(Z.Zb,{className:"whitespace-nowrap",children:i.repo}),(0,l.jsxs)(B.U,{align:"center",space:2,children:[(0,l.jsx)(O.JO,{icon:f.I0,size:"sm"}),(0,l.jsx)(Z.Zb,{children:i.branch})]}),null!=i.rootDirectory&&""!==i.rootDirectory.trim()&&(0,l.jsxs)(B.U,{align:"center",space:2,children:[(0,l.jsx)(O.JO,{icon:f.gt,size:"sm"}),(0,l.jsx)(Z.Zb,{children:i.rootDirectory})]})]})]})]})}):null!=a.creator?(0,l.jsxs)(em,{children:[(0,l.jsx)(O.JO,{icon:f.oI,size:"2xl",className:"bg-white dark:bg-black bg-opacity-50 dark:bg-opacity-50 border border-gray-200 p-2 rounded-lg"}),(0,l.jsxs)(B.g,{children:[(0,l.jsx)(Z.xv,{className:"mb-1.5",children:"railway up"}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center text-gray-400 space-x-3 md:space-x-6 max-w-full",children:[(0,l.jsx)(Z.Zb,{children:null!==(r=null===(t=a.creator)||void 0===t?void 0:t.name)&&void 0!==r?r:null===(n=a.creator)||void 0===n?void 0:n.email}),null!=i.rootDirectory&&""!==i.rootDirectory.trim()&&(0,l.jsxs)(B.U,{align:"center",space:2,children:[(0,l.jsx)(O.JO,{icon:f.gt,size:"sm"}),(0,l.jsx)(Z.Zb,{children:i.rootDirectory})]})]})]})]}):null]})},em=L.dy.div(es());var ep=n(28879),eg=n.n(ep),ex=n(37559),eh=n(52737),ev=n(16436),ey=n(18345),ef=n(26343),eb=n(51952);let ej=e=>{let{deployment:t,deploymentId:n,hideActions:r,showAdminLinks:i,showBackLink:s}=e,{routes:o}=(0,M.H)(),{modalActions:d}=(0,p.o)(),[,u]=(0,U.F)(),[{serviceInstance:g,service:x,permissions:h}]=(0,c.PY)(),v=n.substring(0,7),y=(null==t?void 0:t.status)===a.Wtj.Initializing||(null==t?void 0:t.status)===a.Wtj.Building||(null==t?void 0:t.status)===a.Wtj.Deploying,b=(null==t?void 0:t.status)===a.Wtj.Failed||(null==t?void 0:t.status)===a.Wtj.Crashed,w=(null==t?void 0:t.status)===a.Wtj.Success;return(0,l.jsxs)("div",{className:"grid gap-6 pt-8 px-5 md:px-12 md:pt-10 z-50",children:[(0,l.jsxs)("div",{className:"grid gap-3 grid-cols-[auto_1fr_auto] items-center w-full",children:[(0,l.jsxs)(B.U,{space:3,align:"center",children:[(0,l.jsxs)(j.r,{variant:"highlight",...o.projectServiceDeployments({}),className:"flex items-center space-x-3 group",children:[(0,l.jsx)(O.JO,{size:"lg",icon:(null==x?void 0:x.icon)!=null?()=>(0,l.jsx)(f.XB,{src:x.icon}):null!=(0,k.getRepoSource)(null==g?void 0:g.source)?f.Tf:f.oI,className:"cursor-pointer"}),(0,l.jsx)(Z.$2,{as:"span",className:"text-gray-500 font-medium group-hover:text-pink-600",children:null==x?void 0:x.name})]}),(0,l.jsx)("span",{className:"text-gray-200",children:"∕"}),(0,l.jsx)("button",{onClick:()=>{u(v),d.createToast((0,l.jsx)(m.FN,{title:"Copied deployment ID",variant:"success",description:"Feel free to paste it in the Railway Discord"}))},className:"text-sm text-gray-500 font-mono hover:text-pink-600",children:v})]}),null!=t?(0,l.jsx)(Z.$2,{className:"hidden md:block text-gray-500 text-right",children:eg()(t.createdAt).format("MMM D, YYYY h:mm a")}):(0,l.jsx)(ey.B,{width:"100px",height:"21px",className:"justify-self-end"}),s&&(0,l.jsx)(V.ZP,{icon:f.X,variant:"ghost",color:"gray",size:"sm",...o.projectServiceDeployments({}),className:"col-start-3 text-gray-500"})]}),(0,l.jsxs)("div",{className:"grid gap-4 grid-cols-[auto_1fr_auto] items-center min-h-[36px]",children:[null!=t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.OM,{className:(0,L.AK)("col-start-1 border px-2 py-1 font-medium uppercase rounded-full","text-gray-500 dark:text-gray-600 bg-gray-50 border-gray-200 dark:border-gray-300",y&&"!text-blue-500 dark:!text-blue-600 !bg-blue-50 !border-blue-200 dark:!border-blue-300",b&&"text-red-500 dark:text-red-600 bg-red-50 border-red-200 dark:border-red-300",w&&"text-green-500 dark:text-green-600 bg-green-50 border-green-200 dark:border-green-300"),children:t.status===a.Wtj.Success?"active":t.status}),null!=t?(0,l.jsx)(Z.$2,{className:"block md:hidden text-gray-500",children:eg()(t.createdAt).format("MMM D, YYYY h:mm a")}):(0,l.jsx)(ey.B,{width:"100px",height:"21px",className:"justify-self-end"}),(0,l.jsx)(ek,{deployment:t,className:"row-start-2 col-span-4 md:row-start-1 md:col-start-2 md:col-span-1"})]}):(0,l.jsx)("div",{className:"py-1 col-span-2",children:(0,l.jsx)(ey.B,{width:"62px",height:"28px"})}),!r&&h.Write&&(0,l.jsxs)(ev.Lt,{children:[(0,l.jsx)(ev.z,{title:"Deployment actions",icon:f.hl,className:"col-start-3 w-9 h-9 text-gray-500 border border-gray-200 flex justify-center items-center hover:bg-gray-100"}),null!=t&&(0,l.jsx)(eN,{deployment:t})]})]}),i&&null!=t&&(0,l.jsx)(ew,{deployment:t}),(0,l.jsx)(_.i,{className:"!my-0"})]})},ew=e=>{var t;let{deployment:n}=e,{actions:r}=(0,o.v)({...n,environmentId:n.environment.id}),{routes:i}=(0,M.H)(),{modalActions:a}=(0,p.o)();return(0,l.jsx)(b.j,{icon:f.HE,children:(0,l.jsxs)(B.U,{space:2,align:"center",className:"w-full",children:[(0,l.jsx)(Z.$2,{className:"mr-auto",children:"Admin Actions"}),(0,l.jsx)(V.ZP,{...i.projectServiceDeployments({projectId:n.projectId,serviceId:null!==(t=n.serviceId)&&void 0!==t?t:"",deploymentId:n.id}),external:!0,variant:"outline",size:"xs",children:"Go to project"}),(0,l.jsx)(V.ZP,{onClick:r.downloadSnapshot,variant:"outline",size:"xs",children:"Download code"}),(0,l.jsx)(V.zx,{color:"red",variant:"outline",size:"xs",onClick:()=>{null==n.creator?a.createToast((0,l.jsx)(m.FN,{variant:"error",title:"Cannot Ban",description:"Deployment does not have a creator"})):a.openModal((0,l.jsx)(ef.u_,{title:"Ban User",children:(0,l.jsx)(eh.BanUserReason,{user:n.creator})}))},className:"max-w-max",children:"Ban User"})]})})},eN=e=>{let{deployment:t}=e,{actions:n}=(0,o.v)({...t,environmentId:t.environment.id});return(0,l.jsxs)(ev.Nv,{align:"end",children:[null!=n.cancelDeployment&&(0,l.jsx)(ev.hP,{onSelect:n.cancelDeployment,name:"Abort",className:"text-red-500",children:"Abort"}),null!=n.restartDeployment&&(0,l.jsx)(ev.hP,{onSelect:n.restartDeployment,name:"Restart",children:"Restart"}),null!=n.rollbackDeployment&&(0,l.jsx)(ev.hP,{onSelect:n.rollbackDeployment,name:"Rollback",children:"Rollback"}),null!=n.redeployDeployment&&(0,l.jsx)(ev.hP,{onSelect:n.redeployDeployment,name:"Redeploy",children:"Redeploy"}),null!=n.removeDeployment&&(0,l.jsx)(ev.hP,{onSelect:n.removeDeployment,name:"Remove",className:"text-red-500",children:"Remove"})]})},ek=e=>{var t;let{deployment:n,className:r,...i}=e,s=n.status===a.Wtj.Initializing||n.status===a.Wtj.Building||n.status===a.Wtj.Deploying,o=(0,ex.l)(n.staticUrl);return(0,l.jsx)("div",{...i,className:(0,L.AK)(r,"overflow-hidden overflow-ellipsis"),children:n.status===a.Wtj.Success?(0,l.jsx)(l.Fragment,{children:null!=n.staticUrl?(0,l.jsx)("div",{className:"font-medium whitespace-nowrap",children:o?n.staticUrl:(0,l.jsx)(j.r,{href:"https://".concat(n.staticUrl),variant:"highlight",name:"Deployment Detail Open Deployment",children:n.staticUrl})}):(0,l.jsx)(eb.q,{projectId:n.projectId,environmentId:n.environment.id,serviceId:null!==(t=n.serviceId)&&void 0!==t?t:""})}):n.status===a.Wtj.Failed?(0,l.jsx)(Z.nq,{children:"Deployment Failed during build process"}):n.status===a.Wtj.Crashed?(0,l.jsx)(Z.nq,{children:"Deployment has crashed"}):s?(0,l.jsx)(Z.nq,{children:"Deployment is in progress"}):null})};var eD=n(79583);let eS="deployment-metro-pane",eC=e=>{let t=()=>null==e?"details":e.status===a.Wtj.Initializing?"details":e.status===a.Wtj.Building||e.status===a.Wtj.Deploying||e.status===a.Wtj.Skipped||e.status===a.Wtj.Failed?"build":"deploy",[n,l]=(0,i.useState)(t());return(0,i.useEffect)(()=>{l(t())},[null==e?void 0:e.status]),[n,l]},eP=e=>{var t;let{deploymentId:n,hideActions:r=!1,showAdminLinks:i=!1,showBackLink:a=!1}=e,{deployment:s}=(0,u.C)(n);return(0,x.FB)(null===(t=s.data)||void 0===t?void 0:t.status),(0,l.jsx)(N.JV,{className:(0,L.AK)(eS,"grid-rows-[minmax(0px,_1fr)]"),children:(0,l.jsx)(eF,{deploymentId:n,hideActions:r,showAdminLinks:i,showBackLink:a,deployment:s.data})})},eF=e=>{var t,n,a;let{deploymentId:o,deployment:c,hideActions:d,showAdminLinks:u,showBackLink:m}=e;g(null==c?void 0:null===(t=c.environment)||void 0===t?void 0:t.id);let[{user:p}]=(0,eD.aF)(),[x,b]=(0,i.useState)(""),j=(0,v._)();(0,s.qN)(()=>({value:"log-preferences",text:"Log Preferences",group:"Deployment",highlighted:!0,icon:f.Zr,subCommands:j}),[j]),(0,s.qN)(()=>({value:"open-deployment-temporal-".concat(o),text:"Open in Temporal",icon:f.dL,group:"Admin",action:()=>{window.open((0,K.vO)(o))},isAvailable:()=>null!==(n=null==p?void 0:p.isAdmin)&&void 0!==n&&n}),[null==p?void 0:p.isAdmin,o]);let[N,k]=eC(c),D=(0,i.useRef)(null),S=(0,i.useRef)(null),C=(0,y.n)();return(0,i.useEffect)(()=>{C?(D.current=document.querySelector(".".concat(eS)),S.current=document.querySelector(".tabs-root")):(D.current=null,S.current=null)},[C]),(0,h.b)({scrollContainer:D,childContainer:S}),(0,l.jsxs)(r.fC,{value:N,onValueChange:k,className:(0,L.AK)("tabs-root","grid relative","grid-rows-[auto_auto_minmax(0px,_1fr)] h-full"),children:[null!=c&&(0,l.jsx)(eA,{deployment:c}),(0,l.jsx)(ej,{deploymentId:o,deployment:c,hideActions:d,showAdminLinks:u,showBackLink:m}),(0,l.jsx)(w.Qs,{openLogs:null!=c?N:"",activeFilter:x,setActiveFilter:b,tabs:[{label:"Details",value:"details"},{label:"Build",value:"build",appendLogs:!0},{label:"Deploy",value:"deploy",appendLogs:!0}]}),null!=c?(0,l.jsx)(eM,{deployment:c,filter:x,scrollParent:null!==(a=D.current)&&void 0!==a?a:void 0}):(0,l.jsx)("div",{className:"h-full bg-secondaryBg dark:bg-gray-100"})]})},eA=e=>{let{deployment:t}=e;return d({...t,environmentId:t.environment.id}),null},eM=e=>{var t;let{deployment:n,filter:i,scrollParent:a}=e;return(null===(t=null==n?void 0:n.meta)||void 0===t?void 0:t.logsV2)!==!0?(0,l.jsx)("div",{children:(0,l.jsx)(b.j,{variant:"info",className:"my-3",children:(0,l.jsxs)("p",{children:["Please re-deploy to upgrade to the new"," ",(0,l.jsxs)(j.r,{href:"https://blog.railway.app/p/building-logs-v2",children:[(0,l.jsx)("span",{className:"underline peer",children:"logging experience"}),(0,l.jsx)("span",{"aria-hidden":!0,className:"ml-1 invisible peer-hover:visible",children:"↗"})]})]})})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.VY,{value:"details",className:"outline-black",children:(0,l.jsx)(eo,{deployment:n})}),(0,l.jsx)(r.VY,{value:"build",children:(0,l.jsx)(F,{deployment:n,filter:i,scrollParent:a},"build-logs-".concat(n.id))}),(0,l.jsx)(r.VY,{value:"deploy",children:(0,l.jsx)(I,{deployment:n,filter:i,scrollParent:a},"deploy-logs-".concat(n.id))})]})}},21780:function(e,t,n){n.d(t,{Mb:function(){return L},Qs:function(){return E}});var l=n(52322),r=n(2784),i=n(23453),a=n(25460),s=n(5326),o=n(64319),c=n(23839),d=n(57507),u=n(14307),m=n(67168),p=n(4735),g=n(98937),x=n(39933),h=n(16163),v=n(67421),y=n(9103),f=n(40214),b=n(79583),j=n(31921),w=n(12714),N=n.n(w),k=n(27873),D=n(67846),S=n(92762),C=n(68663),P=n(48212),F=n(77967);let A=/(\b(https?):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gim,M="127.0.0.1",I=()=>{let[{user:e}]=(0,b.aF)(),[t,n]=(0,o.$)(),[i,a]=(0,r.useState)(!1);return(0,l.jsxs)(c.fC,{onOpenChange:e=>a(e),children:[(0,l.jsxs)(c.xz,{className:(0,F.AK)("flex items-center rounded py-1.5 px-3 hover:bg-gray-200",i&&"bg-gray-200"),children:[(0,l.jsx)(d.JO,{icon:u.Zr,size:"sm",className:"mr-2 !text-gray-500"}),"Log Preferences"]}),(0,l.jsxs)(c.VY,{sideOffset:8,side:"bottom",className:"bg-background rounded-md py-1.5",children:[(0,l.jsx)(m.X,{size:"xs",isSelected:t.timestamps,onChange:e=>n(t=>({...t,timestamps:e})),className:"px-4 py-1 text-sm relative",children:"Timestamps"}),(0,l.jsx)(m.X,{size:"xs",isSelected:t.wordWrap,onChange:e=>n(t=>({...t,wordWrap:e})),className:"px-4 py-1 text-sm",children:"Line wrapping"}),(0,l.jsx)(m.X,{size:"xs",isSelected:t.severity,onChange:e=>n(t=>({...t,severity:e})),className:"px-4 py-1 text-sm",children:"Stderr highlighting"}),(null==e?void 0:e.isAdmin)&&(0,l.jsx)(m.X,{size:"xs",isSelected:t.infinite,onChange:e=>n(t=>({...t,infinite:e})),className:"px-4 py-1 text-sm",children:"Infinite scroll"})]})]})},R=e=>{let{isAtTop:t,isAtBottom:n,scrollToBottom:r,scrollToTop:i}=e;return(0,l.jsxs)("div",{className:(0,F.AK)("space-y-1","hidden","sm:block sm:fixed sm:bottom-[3.5rem] sm:right-12 sm:lg:right-8"),children:[(0,l.jsx)(p.hU,{title:"Jump to top",icon:u.a2,disabled:t,variant:"outline",onClick:i,className:"bg-gray-100 hover:bg-gray-200 disabled:hover:bg-gray-100 disabled:active:scale-100"}),(0,l.jsx)(p.hU,{title:"Jump to bottom",icon:u.K5,disabled:n,variant:"outline",onClick:r,className:"bg-gray-100 hover:bg-gray-200 disabled:hover:bg-gray-100 disabled:active:scale-100"})]})},E=e=>{let{openLogs:t,activeFilter:n,setActiveFilter:i,tabs:a}=e,[s,o]=(0,r.useState)(n),{track:c}=(0,g.K)(),d=()=>{c({action:"Submit",object:"Logs Search",properties:{filter:s}}),i(s)};return(0,l.jsxs)(x.aV,{className:(0,F.AK)("grid grid-cols-[auto_auto_auto_1fr_minmax(min-content,_320px)] gap-4 py-4","sticky top-0 bg-background dark:bg-secondaryBg px-5 md:px-12 border-b border-gray-200 w-auto z-10"),children:[a.map(e=>(0,l.jsxs)(z,{value:e.value,active:t===e.value,onMouseUpCapture:()=>c({action:"Click",object:"Show ".concat(e.label," Logs Button")}),children:[e.label," ",e.appendLogs&&(0,l.jsx)("span",{className:"hidden md:inline",children:" Logs"})]},e.value)),"details"!==t&&(0,l.jsxs)(h.l0,{enableBindings:!0,onSubmit:()=>d(),className:"hidden md:grid col-start-5 grid-cols-[1fr_auto] w-full",children:[(0,l.jsx)(v.II,{value:s,onChange:e=>o(e.target.value),name:"filter",label:{text:"Filter",hidden:!0},size:"sm",placeholder:'Filter logs using "", (), AND, OR, -',className:"rounded-r-none"}),(0,l.jsx)(p.hU,{size:"sm",title:""!==n?"Clear filter":"Search",icon:""!==n?u.X:u.HN,variant:"outline",type:""!==n?"button":"submit",onClick:()=>{""!==n&&(i(""),o(""))},className:"-ml-px h-auto rounded-l-none w-9"})]})]})},T=e=>{let{isLoading:t,numLogs:n}=e;return(0,l.jsxs)("footer",{className:(0,F.AK)("row-start-3 hidden sm:flex sticky bottom-0","px-5 md:px-12 py-2 h-9 items-center justify-between bg-gray-100 border-t border-gray-200 text-xs text-gray-600"),children:[t?(0,l.jsx)(i.gb,{}):(0,l.jsxs)(a.OM,{children:["Showing ",n," ",(0,s._6)("log",n)]}),(0,l.jsx)(I,{})]})},L=e=>{var t;let{subscription:n,logs:i,noMoreLogs:s,isLoadingMore:c,pageSize:d=1,loadMore:m,emptyMessage:g,stickyScrollParent:x,warnings:h=[]}=e,v=(0,r.useRef)(null),b=(0,j.P)("sm"),w=!b,{routes:F}=(0,C.H)(),[{wordWrap:I,timestamps:E,infinite:L,severity:z}]=(0,o.$)(),[O,B]=(0,r.useState)(!w),[Z,U]=(0,r.useState)(w),W=new(N());W.use_classes=!0;let K=(0,r.useMemo)(()=>[...i,...null!==(t=null==n?void 0:n.data)&&void 0!==t?t:[]].map(e=>{let t=W.ansi_to_html(e.message||" ").replace(A,'<a href="$1" style="text-decoration:underline" target="_blank" rel="noopener noreferrer">$1</a>');return{...e,html:t}}),[i.length,null==n?void 0:n.data.length]),J=Number.MAX_SAFE_INTEGER-d-i.length,H=null!=n&&n.data.length<d||s,[Q,Y]=(0,S.ZP)("@railway/logs/showLocalhostWarning",!0),V=(0,k.Zf)(M,n);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"h-full grid grid-rows-[auto_minmax(0px,_1fr)_auto]",children:[V&&Q&&(0,l.jsxs)(D.j,{size:"sm",variant:"info",className:"flex items-center rounded-none -mx-5 md:-mx-12 px-5 md:px-12",children:[(0,l.jsxs)("p",{className:"w-full",children:["Looks like your app is listening on"," ",(0,l.jsx)(a.ZM,{children:M}),"."," ",(0,l.jsxs)(P.r,{variant:"underline",...F.docs({page:"deploy/exposing-your-app"}),children:["You may need to listen on ",(0,l.jsx)(a.ZM,{children:"0.0.0.0"})," ","instead"]}),"."]}),(0,l.jsx)(p.hU,{title:"Dismiss",size:"sm",icon:u.X,onClick:()=>Y(!1)})]}),h.length>0&&(0,l.jsx)(D.j,{size:"sm",variant:"warning",className:"flex items-center rounded-none px-5 md:px-12",children:h.join("\n")}),(0,l.jsxs)(_,{wordWrap:I,children:[0!==K.length||c||(null==n?void 0:n.isLoading)?(0,l.jsx)(y.OO,{ref:v,data:K,followOutput:Z,initialTopMostItemIndex:w?Number.MAX_SAFE_INTEGER:0,firstItemIndex:J,increaseViewportBy:1e3,customScrollParent:x,atBottomThreshold:10,atTopThreshold:10,atTopStateChange:async e=>{B(e),null!=m&&L&&e&&!c&&!H&&0!==K.length&&m(K[0])},atBottomStateChange:e=>{0!==K.length&&U(e)},components:{Header:()=>0===K.length||H||null==m?(0,l.jsx)("div",{className:"h-5"}):L?(0,l.jsx)(f.Qp,{className:"py-2 text-gray-500",children:"fetching more..."}):(0,l.jsx)(f.Qp,{className:"py-2",children:(0,l.jsx)(p.zx,{size:"xs",color:"gray",name:"Load More Logs",onClick:()=>{null!=m&&m(K[0])},disabled:c,children:"Load More"})}),Footer:()=>(0,l.jsx)("div",{className:"h-5"})},computeItemKey:(e,t)=>t.timestamp,itemContent:(e,t)=>(0,l.jsx)(f.$O,{log:t,showTimestamps:E,showSeverity:z})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(f.Qp,{className:"text-gray-500",children:[(0,l.jsx)("br",{}),g]})}),(0,l.jsx)(R,{isAtTop:O,isAtBottom:Z,scrollToTop:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.scrollTo({top:0})},scrollToBottom:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.scrollToIndex(K.length)}})]}),(0,l.jsx)(T,{isLoading:null==n?void 0:n.isLoading,numLogs:K.length})]})})},z=(0,F.Lq)(x.xz)(e=>{let{active:t}=e;return["h-sm py-1.5 px-3 rounded-md text-sm leading-5 space-x-2 font-medium cursor-pointer transition-colors","hover:bg-gray-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-pink-500",t&&"!bg-gray-100"]}),_=(0,F.Q$)("div")(e=>{let{wordWrap:t}=e;return["row-start-2 bg-gray-100 h-full max-h-full overflow-x-auto","text-xs font-mono cursor-text",t?"whitespace-pre-wrap":"whitespace-pre"]})},40214:function(e,t,n){n.d(t,{$O:function(){return d},LI:function(){return p},Qp:function(){return u}});var l=n(92228),r=n(52322),i=n(28879),a=n.n(i),s=n(77967);function o(){let e=(0,l.Z)(["text-xs text-gray-600 select-none cursor-text pointer-events-none"]);return o=function(){return e},e}function c(){let e=(0,l.Z)(["ansi-color-wrapper"]);return c=function(){return e},e}let d=e=>{var t,n;let{log:l,showTimestamps:i,showSeverity:s}=e;return(0,r.jsxs)(u,{severity:s&&null!==(t=l.severity)&&void 0!==t?t:void 0,children:[(0,r.jsx)(m,{children:i?a()(null!==(n=l.timestamp)&&void 0!==n?n:0).format("MMM DD HH:mm:ss.SSS")+" ":(0,r.jsx)(r.Fragment,{children:"\uFEFF"})}),(0,r.jsx)(p,{dangerouslySetInnerHTML:{__html:l.html}})]})},u=(0,s.Q$)("div")(e=>{let{severity:t}=e;return["px-5 md:px-12","err"===t?"bg-red-100 dark:bg-red-200":""]}),m=s.dy.span(o()),p=s.dy.span(c())},11892:function(e,t,n){n.d(t,{jh:function(){return k},JV:function(){return D},yv:function(){return S},Ob:function(){return N},Aj:function(){return C}});var l,r,i=n(92228),a=n(52322),s=n(38532),o=n(2784),c=n(31921),d=n(27728);(l=r||(r={}))[l.Safari=0]="Safari",l[l.MobileSafari=1]="MobileSafari";let u={[r.MobileSafari]:e=>{let t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),n=!!e.match(/WebKit/i),l=t&&n&&!e.match(/CriOS/i);return l},[r.Safari]:e=>{let t=/^((?!chrome|android).)*safari/i.test(e);return t}},m=e=>{var t;let n=(0,d.t)(),l=(0,o.useMemo)(()=>null!=navigator&&null!==(t=navigator.userAgent)&&void 0!==t?t:"",[]),r=(0,o.useMemo)(()=>u[e](l),[l]);return n&&r};var p=n(68663),g=n(14307),x=n(77967),h=n(60018),v=n(4735),y=n(57507),f=n(64648),b=n(25460),j=n(84577);function w(){let e=(0,i.Z)(["\n  grid grid-cols-[minmax(0px,_1fr)] md:grid-cols-[auto]\n  w-full min-h-full bg-background dark:bg-secondaryBg\n  sm:overflow-auto sm:h-full\n"]);return w=function(){return e},e}let N=e=>{let{children:t,...n}=e;return(0,a.jsx)("div",{...n,className:(0,x.AK)(n.className,"metro-pane-wrapper","grid justify-items-end inset-0 relative z-40 row-start-2 sm:row-start-1 overflow-hidden","px-0 min-w-full w-auto","sm:h-full","md:mx-5 md:min-w-[initial]","lg:mx-0 col-start-2"),children:t})},k=o.forwardRef((e,t)=>{let{isBehind:n,animateFromTop:l,focusFromBehind:i,hideFromFront:d,onMouseEnter:u,onMouseLeave:p,disableTransition:g,children:v,...y}=e,f=(0,c.P)("md"),b=!(0,c.P)("xl"),j=m(r.Safari);return(0,o.useEffect)(()=>{j&&!n&&setTimeout(async()=>{let e=document.querySelector(".metro-pane");null!=e&&(e.style.display="block",await new Promise(e=>setTimeout(e,10)),e.style.display="grid")},10)},[j,n]),(0,a.jsx)(s.E.div,{ref:t,onMouseEnter:u,onMouseLeave:p,className:(0,x.AK)("metro-pane","top-0 bottom-0 right-0 z-40","md:mt-6 md:border md:rounded-t-xl overflow-hidden","lg:border-r-0 lg:border-l lg:border-t lg:rounded-none lg:rounded-tl-xl",n&&"md:border lg:border lg:rounded-t-xl lg:block",i&&"z-50","w-full xl:w-[calc(100%-24px)]"),...y,...f&&n?{"aria-hidden":"true"}:{},transition:g?{duration:0}:{type:"spring",damping:40,stiffness:440},initial:!f&&"enter",animate:"visible",exit:"leave",variants:{enter:{x:l&&!f?h.k:"20%",y:l&&!f?-h.k:0,position:"absolute",opacity:0,userSelect:"none"},visible:{x:n&&b?-h.k:0,y:i?0:n&&b?h.k:d?h.k:0,position:n?"absolute":"static",opacity:1,userSelect:"initial"},leave:{x:l&&!f?h.k:"20%",y:l&&!f?-h.k:0,position:"absolute",opacity:0,userSelect:"none"}},children:v},"metro-pane")}),D=x.dy.div(w()),S=()=>(0,a.jsx)(D,{}),C=e=>{let{title:t,icon:n,banner:l,tabs:r,children:i,className:s}=e,{routes:o,pathname:c}=(0,p.H)();return(0,a.jsxs)(D,{className:(0,x.AK)(s,null!=l?"grid-rows-[auto_auto_minmax(0px,_1fr)]":"grid-rows-[auto_minmax(0px,_1fr)]"),children:[null!=l&&l,(0,a.jsxs)(f.g,{className:"pt-8 md:px-12 md:pt-12 z-50",children:[(0,a.jsxs)(f.U,{align:"center",space:4,className:"mb-8 px-5 md:px-0",children:[null!=n&&(0,a.jsx)(y.JO,{icon:n,size:"xl",className:"rounded-full text-foreground"}),(0,a.jsx)(b.XJ,{as:"h1",className:"flex items-center flex-grow",children:t}),(0,a.jsx)(v.x6,{...o.project({}),icon:g.X})]}),(0,a.jsx)(j.a,{tabs:r,className:"px-5 md:px-0 border-b !border-gray-100 md:!border-gray-200"})]}),(0,a.jsx)("div",{className:(0,x.AK)("metro-pane-content","sm:overflow-auto"),children:(0,a.jsx)("div",{className:"h-full px-5 pt-8 md:px-12",children:i})},c)]})}},84577:function(e,t,n){n.d(t,{a:function(){return p}});var l=n(92228),r=n(52322),i=n(28957),a=n(38532);n(2784);var s=n(14307),o=n(77967),c=n(57507),d=n(48212),u=n(64648);function m(){let e=(0,l.Z)(["\n  hidden md:block\n  absolute bottom-0 w-full h-px bg-foreground\n"]);return m=function(){return e},e}let p=e=>{let{tabs:t,...n}=e;return(0,r.jsx)(g,{...n,children:(0,r.jsx)(i.S,{id:"header-tabs",children:t.map(e=>(0,r.jsxs)(x,{className:"tab-item tab-item-".concat(e.text.replace(/\s+/,"-")),...e.link,active:e.active,name:"".concat(e.text," Tab"),children:[(0,r.jsxs)(u.U,{align:"center",children:[e.text,e.badge&&(0,r.jsx)(c.JO,{icon:s.kI,size:"sm",className:"ml-1 text-pink-600"})]}),e.active&&(0,r.jsx)(h,{layoutId:"header-indicator",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]},e.text))})})},g=e=>{let{children:t,...n}=e;return(0,r.jsx)(u.U,{align:"center",...n,className:(0,o.AK)(n.className,"space-x-3 md:space-x-8 pb-3 w-full md:pb-0 overflow-x-auto border-b border-gray-100 md:border-transparent"),children:t})},x=(0,o.Lq)(d.r)(e=>{let{active:t}=e;return["relative","inline-block h-10 px-3 py-2 rounded-md",t?"text-foreground bg-gray-100":"text-gray-600 bg-secondaryBg","md:h-auto md:bg-transparent md:p-0 md:pb-3 md:hover:text-foreground md:focus:outline-none md:focus:ring-0 md:focus:text-foreground",t?"md:text-foreground":"text-gray-500"]}),h=(0,o.Lq)(a.E.div)(m())},51952:function(e,t,n){n.d(t,{q:function(){return p}});var l=n(52322),r=n(2784),i=n(89524),a=n(68663),s=n(57846),o=n(25154),c=n(77967),d=n(67846),u=n(4735),m=n(60017);let p=e=>{let{serviceId:t,environmentId:n,projectId:p,className:g,...x}=e,{modalActions:h}=(0,o.o)(),{routes:v}=(0,a.H)(),[y,f]=(0,r.useState)(!1),[,{createServiceDomain:b}]=(0,i.J)({projectId:p,environmentId:n,serviceId:t}),[{suggestAddServiceDomain:j},{dismissSuggestAddServiceDomain:w}]=(0,s.$)({serviceId:t,environmentId:n}),N=async()=>{try{f(!0),await b({})}catch(e){h.createToast((0,l.jsx)(m.FN,{variant:"error",title:"Error adding service domain",description:e.message}))}finally{f(!1)}};return j?(0,l.jsx)(d.j,{size:"sm",variant:"primary",...x,className:(0,c.AK)(g,"!py-1"),children:(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-y-2 w-full",children:[(0,l.jsxs)("p",{className:"flex items-center gap-1 flex-wrap",children:[(0,l.jsx)(u.zx,{name:"Domain Banner Generate",variant:"outline",size:"xs",onClick:N,isLoading:y,className:"inline-flex mt-0.5",children:"Add a Domain"})," ","to expose this ",(0,l.jsx)("span",{className:"font-bold",children:"webserver"}),", or"," ",(0,l.jsx)(u.ZP,{name:"Domain Banner Custom Domain",variant:"outline",size:"xs",...v.projectServiceSettings({}),className:"inline-block mt-0.5",children:"Add Custom Domain"})]}),(0,l.jsx)("button",{name:"Domain Banner Close",type:"button",onClick:w,className:"inline-block underline ml-auto text-pink-600 hover:text-pink-800",children:"Keep Unexposed"})]})}):null}},58317:function(e,t,n){n.d(t,{N:function(){return b},Z:function(){return f}});var l=n(52322),r=n(677),i=n(2784),a=n(28813),s=n(98937),o=n(14307),c=n(20737),d=n(77967),u=n(5326),m=n(63686),p=n(16436),g=n(57507),x=n(64648),h=n(25460),v=n(11670);let y=["node","python","go","ruby","rust","java","c#","f#","deno","php","elixir","dart","clojure","staticfile"],f=e=>"..."===e||"@auto"===e,b=e=>{let{serviceId:t,hasDeployment:n,matchedProviders:o,customPlan:c,nixpacksConfigFile:p,...g}=e,{updateNixpacksPlan:y}=(0,a.r)(t),{track:b}=(0,s.K)(),[w,k]=(0,i.useState)(null!=c.providers?c.providers:["..."]),D=e=>{k(e),setTimeout(()=>y({...c,providers:e}))},S=0===w.length||w.every(f)&&0===o.length,C=w.filter(e=>f(e)).length>0,P=e=>{b({action:"Add",object:"Provider",properties:{provider:e}}),D([...w,e])},F=e=>{b({action:"Remove",object:"Provider",properties:{provider:e}}),D(w.filter(t=>t!==e))},[A,M]=(0,i.useState)(!1),I=n&&null==p,R=I&&w.length>1;return(0,l.jsxs)(x.g,{...g,children:[(0,l.jsxs)(x.U,{align:"center",space:4,className:"mb-3",children:[(0,l.jsx)(v.oC,{className:"mb-0",children:"Providers"}),(0,l.jsx)(m.vw,{})]}),(0,l.jsx)(v.v9,{children:"Language providers that will be used to build the service following the order below"}),(0,l.jsxs)("div",{className:(0,d.AK)("grid grid-cols-[1fr_auto] gap-x-2 items-start border border-gray-100 px-4 pt-3 rounded-lg",!p&&"pb-3"),children:[(0,l.jsx)("div",{children:n?S?(0,l.jsx)(h.Zb,{className:"py-1.5",children:"No providers"}):(0,l.jsx)(r.t.Group,{as:"div",axis:"x",values:w,onReorder:e=>{D(e)},children:(0,l.jsx)("ul",{className:"flex items-center flex-wrap gap-2",children:w.map(e=>f(e)?(0,l.jsx)(r.t.Item,{value:e,as:"li",onDrag:()=>M(!0),onDragEnd:()=>M(!1),drag:R,children:(0,l.jsx)("div",{className:"flex items-center space-x-2",children:o.map(t=>(0,l.jsx)(N,{name:(0,u.kC)(t),devIcon:t,isAuto:!0,onRemove:()=>F(e),isDragging:A,enableEditing:I,enableDragging:R},t))})},e):(0,l.jsx)(r.t.Item,{value:e,as:"li",onDrag:()=>M(!0),onDragEnd:()=>M(!1),drag:R,children:(0,l.jsx)(N,{name:(0,u.kC)(e),devIcon:e,onRemove:()=>F(e),isDragging:A,enableEditing:I,enableDragging:R})},e))})}):(0,l.jsx)(h.Zb,{className:"py-1.5",children:"Create a deployment to auto-detect providers"})}),I&&(0,l.jsx)(j,{existingProviders:w,onAddProvider:P,showAuto:!C}),null!=p&&(0,l.jsxs)("div",{className:"row-start-2 col-span-2 mt-3 -mx-4 px-4 py-2 text-sm bg-gray-50 text-gray-600",children:["Edit ",(0,l.jsx)(h.MZ,{children:"providers"})," in"," ",p," to change"]})]})]})},j=e=>{let{existingProviders:t,showAuto:n,onAddProvider:r}=e,{track:i}=(0,s.K)();return(0,l.jsxs)(p.Lt,{onOpenChange:e=>{e&&i({action:"Open",object:"AddProviderDropdown"})},children:[(0,l.jsx)(p.z,{title:"Add provider",icon:o.v3,className:"rounded-md border border-pink-200 text-pink-500 p-1 hover:(text-pink-500 border-pink-500)"}),(0,l.jsxs)(p.Nv,{align:"end",children:[n&&(0,l.jsx)(w,{name:"Auto",iconOverride:"Railway",onSelect:()=>r("..."),className:"bg-pink-100"}),y.filter(e=>!(null==t?void 0:t.includes(e))).map(e=>(0,l.jsx)(w,{name:e,onSelect:()=>r(e)},e))]})]})},w=e=>{let{name:t,iconOverride:n,onSelect:r,...i}=e;return(0,l.jsxs)(p.hP,{onSelect:r,...i,children:[(0,l.jsx)(k,{name:null!=n?n:t.toLowerCase()}),(0,l.jsx)("span",{children:(0,u.kC)(t)})]})},N=e=>{let{name:t,devIcon:n,isAuto:r,isDragging:i,enableDragging:a,enableEditing:s,onRemove:c,...u}=e;return(0,l.jsxs)("div",{...u,className:(0,d.AK)("group","relative flex items-center px-1.5 py-1.5 rounded-lg",r?"bg-pink-50 dark:bg-pink-100":"bg-gray-50 dark:bg-gray-100",i?"cursor-grabbing":a?"cursor-grab":void 0),children:[s&&(0,l.jsx)(g.JO,{icon:o.xQ,size:"xs",className:(0,d.AK)("mr-1.5",a?"!text-gray-300":"!text-gray-200")}),null!=n&&(0,l.jsx)(k,{name:n}),(0,l.jsx)(h.xv,{className:"whitespace-nowrap ml-1.5 mr-1",children:t}),s&&null!=c&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),c&&c()},className:"text-gray-200 dark:text-gray-300 p-1.5 rounded-md hover:bg-black hover:bg-opacity-[2%] hover:text-gray-300 hover:dark:text-gray-400",children:(0,l.jsx)(g.JO,{icon:o.X,size:"xs"})})]})},k=e=>{let{name:t,...n}=e,{colorMode:r}=(0,c.Fg)();return(0,l.jsx)("img",{src:"https://devicons.railway.app/".concat(t,"?variant=").concat("light"===r?"dark":"light"),alt:"",...n,className:"w-5 h-5 pointer-events-none"})}},11670:function(e,t,n){n.d(t,{DC:function(){return S},Jh:function(){return C},NZ:function(){return P},QQ:function(){return w},jK:function(){return f},oC:function(){return b},rd:function(){return k},v9:function(){return j},y2:function(){return N}});var l=n(92228),r=n(52322),i=n(92762),a=n(14307),s=n(67846),o=n(57507),c=n(25460),d=n(61570),u=n(77967);function m(){let e=(0,l.Z)(["flex flex-col"]);return m=function(){return e},e}function p(){let e=(0,l.Z)(["text-sm font-semibold mb-3"]);return p=function(){return e},e}function g(){let e=(0,l.Z)(["mb-4"]);return g=function(){return e},e}function x(){let e=(0,l.Z)([""]);return x=function(){return e},e}function h(){let e=(0,l.Z)(["space-y-1 mt-4 mb-8"]);return h=function(){return e},e}function v(){let e=(0,l.Z)(["\n  grid grid-cols-12 py-8 border-t border-gray-100 max-w-4xl\n"]);return v=function(){return e},e}function y(){let e=(0,l.Z)(["col-span-12 md:col-span-4 md:pb-0"]);return y=function(){return e},e}let f=u.dy.div(m()),b=u.dy.label(p()),j=(0,u.Lq)(c.Zb)(g()),w=u.dy.section(x()),N=u.dy.header(h()),k=u.dy.div(v()),D=u.dy.div(y()),S="col-span-12 md:col-span-8 md:col-start-5 space-y-8",C=e=>{let{title:t,danger:n,children:l,...s}=e,[m,p]=(0,i.ZP)("@railway/serviceSettings/".concat(t),!0);return(0,r.jsxs)(k,{...s,children:[(0,r.jsx)(D,{children:(0,r.jsxs)("button",{"aria-controls":t,"aria-expanded":!!m&&"true",onClick:()=>{p(!m)},className:"flex items-center space-x-3 w-full",children:[(0,r.jsx)(o.JO,{icon:m?a._M:a.Kh,className:n?"!text-red-500":"!text-gray-500"}),(0,r.jsx)(c.Cd,{className:n?"text-red-500":"",children:t})]})}),(0,r.jsx)(d.h,{isOpen:m,className:(0,u.AK)("col-span-12 md:col-span-8 md:col-start-5 space-y-8","pt-8 md:pt-0"),children:l})]})},P=e=>{let{field:t,children:n}=e;return(null==t?void 0:t.path)==null?(0,r.jsx)(r.Fragment,{children:n}):(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)(s.j,{size:"sm",variant:"info",className:"mb-4",children:(0,r.jsxs)("span",{children:["This comes from"," ",(0,r.jsx)("span",{className:"text-xs font-mono text-pink-500 dark:text-pink-600 break-all",children:t.path})," ","in ",t.configFile]})}),(0,r.jsx)("div",{className:"opacity-40",children:n})]})}},18845:function(e,t,n){n.d(t,{N:function(){return l}});let l=500},26330:function(e,t,n){n.d(t,{v:function(){return y}});var l=n(52322),r=n(2784),i=n(60017),a=n(40940),s=n(14307),o=n(25154),c=n(13235),d=n(82066),u=n(10715),m=n(50361),p=n(16231),g=n(8560),x=n(67930);let h=e=>{let{projectId:t,environmentId:n,serviceId:r}=e,{graphqlClient:s}=(0,p.S)(),{projectDeploymentsQueryKey:c,setProjectDeployment:h}=(0,m.s)({projectId:t,environmentId:n,serviceId:r,disabled:!0}),[{project:v},{optimisticallyUpdateProject:y}]=(0,x.PY)(),f=(0,d.useQueryClient)(),b=e=>{var t;h(e,e=>({...e,status:a.Wtj.Removed,url:null})),f.setQueryData((0,u.K)(e),e=>({...e,status:a.Wtj.Removed})),y({...v,services:(null!==(t=null==v?void 0:v.services)&&void 0!==t?t:[]).map(t=>({...t,deployments:t.deployments.map(t=>t.id===e?{...t,status:a.Wtj.Removed,url:null}:t)}))})},{modalActions:j}=(0,o.o)(),w=e=>t=>{j.createToast((0,l.jsx)(i.FN,{title:"Error ".concat(e,": ").concat(t.message),variant:"error"}))},N=(0,g.f)(c,async e=>{await s.deploymentRollback({id:e}),f.invalidateQueries((0,u.K)(e))},w("Rolling back deployment")),k=(0,g.f)(c,async e=>{b(e),await s.deploymentRemove({id:e}),f.invalidateQueries((0,u.K)(e))},w("Removing deployment")),D=(0,g.f)(c,async e=>{b(e),await s.deploymentCancel({id:e}),f.invalidateQueries((0,u.K)(e))}),S=(0,g.D)(c,async e=>(await s.deploymentSnapshotCodeUri({deploymentId:e})).deploymentSnapshotCodeUri),C=(0,g.D)(c,async e=>{await s.deploymentRestart({id:e})}),P=(0,g.D)(c,async e=>{let t=(await s.deploymentRedeploy({id:e})).deploymentRedeploy;return t.id});return{removeDeployment:k,cancelDeployment:D,rollbackDeployment:N,getDeploymentSnapshotCodeUrl:S,restartDeployment:C,redeployDeployment:P}};var v=n(68663);let y=e=>{var t,n;let[d,u]=(0,r.useState)(!1),{routes:m,navActions:p}=(0,v.H)(),{confirm:g}=(0,c.p)(),{modalActions:x}=(0,o.o)(),y=h({projectId:e.projectId,environmentId:null!==(t=e.environmentId)&&void 0!==t?t:void 0,serviceId:null!==(n=e.serviceId)&&void 0!==n?n:void 0}),f=(e,t,n)=>async()=>{let r=await g(e);if(r){try{u(!0),await t(),null!=n&&n()}catch(e){x.createToast((0,l.jsx)(i.FN,{title:e.message,variant:"error"}))}u(!1)}},b=async()=>{let t=await y.getDeploymentSnapshotCodeUrl(e.id);null!=t&&window.location.assign(t)},j=()=>{p.push(null!=e.serviceId?m.projectServiceDeployments({deploymentId:e.id}):m.projectDeploy({deploymentId:e.id}),{scroll:!1})},w=e.status,N=(0,r.useMemo)(()=>e.canRollback&&"REMOVED"===w?f({title:"Rollback Deployment",description:"Are you sure you want to revert to this deployment? This will restore both the build and variables.",confirmButtonText:"Rollback"},()=>y.rollbackDeployment(e.id),()=>x.createToast((0,l.jsx)(i.FN,{icon:s.fU,variant:"success",title:"Rollback successful",description:"Your deployment was rolled back!"}))):null,[e.canRollback,w,e.id]),k=(0,r.useMemo)(()=>"SUCCESS"===w||"FAILED"===w||"SKIPPED"===w||"INITIALIZING"===w||"CRASHED"===w?f({title:"Remove Deployment",description:"Are you sure you want to remove this deployment? After removing, it will immediately go offline.",confirmButtonText:"Remove"},()=>y.removeDeployment(e.id),()=>x.createToast((0,l.jsx)(i.FN,{icon:s.fU,variant:"success",title:"Deployment removed",description:"Your deployment was removed!"}))):null,[w,e.id]),D=(0,r.useMemo)(()=>"BUILDING"!==w&&"DEPLOYING"!==w?null:f({title:"Abort deployment",description:"Are you sure you want to abort this deployment? Aborting this deployment is permanent and cannot be undone.",confirmButtonText:"Abort"},()=>y.cancelDeployment(e.id),()=>x.createToast((0,l.jsx)(i.FN,{icon:s.fU,variant:"success",title:"Cancelled",description:"Your deployment was cancelled!"}))),[w,e.id]),S=e.status===a.Wtj.Success,C=(0,r.useMemo)(()=>"SUCCESS"!==w&&"CRASHED"!==w?null:f({title:"Restart deployment",description:"Are you sure you want to restart this deployment? This will restart your ".concat(S?"container":"crashed container","."),confirmButtonText:"Restart",cancelButtonText:"Cancel"},()=>y.restartDeployment(e.id),()=>x.createToast((0,l.jsx)(i.FN,{icon:s.fU,variant:"success",title:"Restart successful",description:"Your deployment was restarted successfully!"}))),[w,e.id]),P=(0,r.useMemo)(()=>"SUCCESS"!==w&&"CRASHED"!==w&&"FAILED"!==w?null:f({title:"Redeploy deployment",description:"Are you sure you want to redeploy this deployment? This will rebuild and deploy your code with the exact same configuration.",confirmButtonText:"Redeploy",confirmButtonColor:"pink",cancelButtonText:"Cancel"},async()=>{let t=await y.redeployDeployment(e.id);p.push(m.projectServiceDeployments({deploymentId:t}))},()=>x.createToast((0,l.jsx)(i.FN,{icon:s.fU,variant:"success",title:"Redeploy started",description:"The build for your new deployment has started"}))),[e.id,w]);return{actions:{openDeployment:j,rollbackDeployment:N,removeDeployment:k,cancelDeployment:D,restartDeployment:C,downloadSnapshot:b,redeployDeployment:P},isLoading:d}}},10715:function(e,t,n){n.d(t,{C:function(){return o},K:function(){return s}});var l=n(63798),r=n(90758),i=n(2784),a=n(16231);let s=e=>["deployment",e],o=e=>{let{graphqlClient:t}=(0,a.S)(),{result:o,setQuery:c}=(0,l.o)(s(e),async()=>(await t.deployment({id:e})).deployment,{retry:1}),d=(0,i.useRef)(),u=(0,i.useRef)(),m=e=>{c(e)};return(0,i.useEffect)(()=>{d.current=new Worker(n.tu(new URL(n.p+n.u(9848),n.b))),u.current=r.Ud(d.current);let l=async()=>(await t.deployment({id:e})).deployment;return u.current.startPolling(r.sj(l),r.sj(m)),()=>{var e;null===(e=d.current)||void 0===e||e.terminate()}},[e]),{deployment:o,refetch:o.refetch}}},50361:function(e,t,n){n.d(t,{s:function(){return s}});var l=n(2784),r=n(82066),i=n(16231);let a=e=>["deployments",e],s=e=>{var t;let{projectId:n,environmentId:s,serviceId:o,refetchInterval:c,disabled:d}=e,{graphqlClient:u}=(0,i.S)(),m=a({projectId:n,environmentId:s,serviceId:o}),p=(0,r.useQueryClient)(),{data:g,error:x,isLoading:h,refetch:v,hasNextPage:y,isFetchingNextPage:f,fetchNextPage:b}=(0,r.useInfiniteQuery)(m,async e=>{let{pageParam:t}=e;return(await u.deployments({input:{projectId:n,environmentId:s,serviceId:o},first:10,after:t})).deployments},{enabled:null!=n&&""!=n.trim()&&!d,refetchInterval:c,getNextPageParam:e=>{var t;return(null==e?void 0:null===(t=e.pageInfo)||void 0===t?void 0:t.hasNextPage)?e.pageInfo.endCursor:null}}),j=(0,l.useMemo)(()=>(null!==(t=null==g?void 0:g.pages)&&void 0!==t?t:[]).flatMap(e=>e.edges.map(e=>e.node)),[null==g?void 0:g.pages]),w=(e,t)=>{var n;let l=(null!==(n=null==g?void 0:g.pages)&&void 0!==n?n:[]).map(n=>({...n,nodes:null==t?n.edges.filter(t=>t.node.id!==e):n.edges.map(n=>n.node.id===e?t(n.node):n.node)}));p.setQueryData(m,e=>({pages:l,pageParams:e.pageParams}))};return{projectDeploymentsQueryKey:m,setProjectDeployment:w,deployments:g,allDeployments:j,isLoading:h,deploymentsError:x,invalidateProjectDeployments:v,hasMoreDeployments:y,isFetchingMoreDeployments:f,fetchMoreDeployments:b}}},89524:function(e,t,n){n.d(t,{J:function(){return c}});var l=n(8560),r=n(82066),i=n(63798),a=n(67930),s=n(16231);let o=(e,t)=>["customDomains",e,t],c=e=>{var t;let{environmentId:n,projectId:c,serviceId:d,options:u={}}=e,{graphqlClient:m}=(0,s.S)(),p=(0,r.useQueryClient)(),g=o(n,d),{result:x,setQuery:h}=(0,i.o)(g,async()=>(await m.domains({projectId:c,environmentId:n,serviceId:d})).domains,{refetchInterval:null!==(t=u.reFetchInterval)&&void 0!==t&&t}),v=(0,l.D)(g,async e=>(await m.customDomainCreate({input:{environmentId:n,serviceId:d,domain:e.domain}})).customDomainCreate),y=(0,l.D)(g,async e=>{null!=x.data&&h({...x.data,customDomains:x.data.customDomains.filter(t=>t.id!==e)}),await m.customDomainDelete({id:e})}),f=(0,l.D)(g,async e=>{let{domain:t}=e;null!=x.data&&h({...x.data,serviceDomains:x.data.serviceDomains.map(e=>({...e,domain:t}))}),await m.serviceDomainUpdate({input:{environmentId:n,serviceId:d,domain:t}})}),b=(0,l.D)(g,async e=>{let{id:t}=e;null!=x.data&&h({...x.data,serviceDomains:x.data.serviceDomains.filter(e=>e.id!==t)}),await m.serviceDomainDelete({id:t}),await p.invalidateQueries((0,a.GX)(c))}),j=(0,l.D)(g,async()=>{await m.serviceDomainCreate({input:{environmentId:n,serviceId:d}}),await p.invalidateQueries((0,a.GX)(c))});return[{domains:x,isError:!1,isLoading:!1},{createCustomDomain:v,deleteCustomDomain:y,updateServiceDomain:f,deleteServiceDomain:b,createServiceDomain:j}]}},42580:function(e,t,n){n.d(t,{M:function(){return s},r:function(){return a}});var l=n(55443),r=n(2784),i=n(23170);let a=e=>{let{repo:t,branch:n,path:l}=e;return"https://github.com/".concat(t,"/edit/").concat(n,"/").concat(l)},s=e=>{let{path:t,serviceInstance:n,environment:s}=e,o=(0,l.getRepoSource)(n.source),{triggers:c}=(0,i.Z)({projectId:s.projectId,environmentId:s.id,serviceId:n.serviceId}),d=(0,r.useMemo)(()=>null!=c.data?c.data[0]:null,[c.data]),u=(0,r.useMemo)(()=>{var e,n;return null==o||null==d?null:a({repo:null!==(e=null==o?void 0:o.repo)&&void 0!==e?e:"",branch:null!==(n=d.branch)&&void 0!==n?n:"",path:null!=t?t:""})},[o,d,t]);return u}},1988:function(e,t,n){n.d(t,{h:function(){return a}});var l=n(2784),r=n(97209);let i=e=>({width:e.offsetWidth,height:e.offsetHeight}),a=e=>{let[t,n]=(0,l.useState)({width:0,height:0}),a=(0,l.useCallback)(()=>{null!=e.current&&n(i(e.current))},[e,n]);return(0,l.useEffect)(()=>{if(null==e.current)return;let t=e.current;try{let e=new r.Z(()=>{a()});return e.observe(t),()=>{e.unobserve(t)}}catch(e){}},[e.current,a]),(0,l.useEffect)(()=>{if(null!=e.current)return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[e.current,a]),(0,l.useEffect)(()=>{a();let e=setTimeout(()=>{a()},1e3);return()=>{clearTimeout(e)}},[e.current,a]),t}},37559:function(e,t,n){n.d(t,{l:function(){return r}});var l=n(2784);let r=e=>(0,l.useMemo)(()=>null!=e&&e.startsWith("*."),[e])},65884:function(e,t,n){n.d(t,{b:function(){return i}});var l=n(2784),r=n(1988);let i=e=>{let{scrollContainer:t,childContainer:n}=e,[i,a]=(0,l.useState)(0),[s,o]=(0,l.useState)(!1),c=(0,r.h)(n);(0,l.useEffect)(()=>{if(null==t.current)return;let e=()=>{if(null==t.current)return;let{clientHeight:e,scrollHeight:n,scrollTop:l}=t.current;n>e&&n-e-l<=5?o(!0):o(!1),a(l)};return e(),t.current.addEventListener("scroll",e),()=>{null!=t.current&&t.current.removeEventListener("scroll",e)}},[t.current,s]),(0,l.useEffect)(()=>{if(null==t.current||!s)return;let e=t.current;e.scrollTop=e.scrollHeight,a(e.scrollTop)},[c.height]);let d=t.current;return{lockedToBottom:s,isAtTop:0===i,isAtBottom:null!=d&&i===d.scrollHeight,canScroll:null!=d&&d.scrollHeight>d.clientHeight}}},64319:function(e,t,n){n.d(t,{$:function(){return i},_:function(){return a}});var l=n(2784),r=n(42598);let i=(0,r.Z)("@railway/logs/preferences",{wordWrap:!1,timestamps:!1,infinite:!1,severity:!1}),a=()=>{let[e,t]=i(),n=(0,l.useMemo)(()=>[{value:"logs-word-wrap",text:e.wordWrap?"Disable word wrap":"Enable word wrap",action:()=>t(e=>({...e,wordWrap:!e.wordWrap}))},{value:"logs-timestamps",text:e.timestamps?"Hide timestamps":"Show timestamps",action:()=>t(e=>({...e,timestamps:!e.timestamps}))},{value:"logs-severity",text:e.severity?"Disable severity colors":"Enable severity colors",action:()=>t(e=>({...e,severity:!e.severity}))},{value:"logs-infinite",text:e.infinite?"Disable infinite scroll":"Enable infinite scroll",onlyAdmin:!0,action:()=>t(e=>({...e,infinite:!e.infinite}))}],[e]);return n}},27873:function(e,t,n){n.d(t,{S7:function(){return s},Tv:function(){return a},Zf:function(){return c},cS:function(){return o}});var l=n(2784),r=n(16231);let i=e=>{let{fn:t,filter:n,limit:r,deps:i}=e,[a,s]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)([]);return(0,l.useEffect)(()=>{u([])},i),[{logs:d,isLoading:a,noMoreLogs:o},{loadMore:async e=>{s(!0);let l=await t({filter:n,limit:r,endDate:e?e.timestamp:new Date().toISOString()});s(!1),c(l.length<r),u(e=>[...l,...e])}}]},a=e=>{let{environmentId:t,pluginId:n,filter:l,limit:a,deps:s}=e,{graphqlClient:o}=(0,r.S)();return i({filter:l,limit:a,deps:s,fn:async e=>(await o.pluginLogs({environmentId:t,pluginId:n,...e})).pluginLogs})},s=e=>{let{deploymentId:t,filter:n,limit:l,deps:a}=e,{graphqlClient:s}=(0,r.S)();return i({filter:n,limit:l,deps:a,fn:async e=>(await s.deploymentLogs({deploymentId:t,...e})).deploymentLogs})},o=e=>{let{deploymentId:t,filter:n,limit:l,deps:a}=e,{graphqlClient:s}=(0,r.S)();return i({filter:n,limit:l,deps:a,fn:async e=>(await s.buildLogs({deploymentId:t,...e})).buildLogs})},c=(e,t)=>(0,l.useMemo)(()=>null!=t&&0!==t.data.length&&t.data.some(t=>t.message.includes(e)),[null==t?void 0:t.data])},34262:function(e,t,n){n.d(t,{$:function(){return s},b:function(){return a}});var l=n(51344),r=n.n(l),i=n(2784);let a=e=>null==e?e:e.replace("_"," ").toLowerCase(),s=e=>{var t,n;let{deployment:l,serviceInstance:a}=e,s=(0,i.useMemo)(()=>{let e={build:{builder:a.builder,watchPatterns:a.watchPatterns,buildCommand:a.buildCommand,nixpacksPlan:a.nixpacksPlan},deploy:{startCommand:a.startCommand,healthcheckPath:a.healthcheckPath,healthcheckTimeout:a.healthcheckTimeout,restartPolicyType:a.restartPolicyType,restartPolicyMaxRetries:a.restartPolicyMaxRetries}};return e},[a]),o=(0,i.useMemo)(()=>null!==(t=null==l?void 0:l.meta)&&void 0!==t?t:{},[l]),c=(0,i.useMemo)(()=>{var e;return null!==(e=o.fileServiceManifest)&&void 0!==e?e:{}},[o,l]),d=(0,i.useCallback)(e=>{let t=e(c);return null!=t},[c]),u=(0,i.useMemo)(()=>{let e=r()({...s},c);return e},[s,c]),m=null!==(n=null==o?void 0:o.serviceManifest)&&void 0!==n?n:{},p=(0,i.useMemo)(()=>{var e;let t=null!==(e=o.propertyFileMapping)&&void 0!==e?e:{},n=e=>t["build.".concat(e)],l=e=>t["deploy.".concat(e)],r={build:{builder:{value:u.build.builder,path:n("builder"),configFile:o.configFile},dockerfilePath:{value:u.build.dockerfilePath,path:n("dockerfilePath"),configFile:o.configFile},watchPatterns:{value:u.build.watchPatterns,path:n("watchPatterns"),configFile:o.configFile},buildCommand:{value:u.build.buildCommand,path:n("buildCommand"),configFile:o.configFile},nixpacksConfigPath:{value:u.build.nixpacksConfigPath,path:n("nixpacksConfigPath"),configFile:o.configFile},nixpacksPlan:{value:u.build.nixpacksPlan,path:n("nixpacksPlan"),configFile:o.configFile}},deploy:{startCommand:{value:u.deploy.startCommand,path:l("startCommand"),configFile:o.configFile},healthcheckPath:{value:u.deploy.healthcheckPath,path:l("healthcheckPath"),configFile:o.configFile},healthcheckTimeout:{value:u.deploy.healthcheckTimeout,path:l("healthcheckTimeout"),configFile:o.configFile},restartPolicyType:{value:u.deploy.restartPolicyType,path:l("restartPolicyType"),configFile:o.configFile},restartPolicyMaxRetries:{value:u.deploy.restartPolicyMaxRetries,path:l("restartPolicyMaxRetries"),configFile:o.configFile}}};return r},[m,u,s,c,d]);return{serviceManifestWithInfo:p,serviceManifest:u,latestManifest:m,fieldComesFromFile:d}}},14351:function(e,t,n){n.d(t,{n:function(){return r}});var l=n(31921);let r=()=>{let e=(0,l.P)("sm");return e}},89499:function(e,t,n){n.d(t,{m:function(){return o}});var l=n(22046),r=n(83473),i=n(91809),a=n(2784),s=n(6513);function o(e,t){var n;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c={data:[],error:null,isLoading:!0===o.enabled,isRetrying:!1},[d,u]=(0,a.useState)(c),[m,p]=(0,l.f)(c,5);return(0,a.useEffect)(()=>p(d),[d]),(0,a.useEffect)(()=>{let n;if(!o.enabled)return;let l=e=>{var t;let{data:n,errors:l}=e;if(l&&(null===(t=l[0])||void 0===t?void 0:t.message)==="retry_later"){u(e=>({...e,isRetrying:!0})),setTimeout(d,2e3);return}let r=Object.keys(n)[0];u(e=>({...e,isLoading:!1,data:function(e,t,n){if(null==n)return[...e,...t];let l=[...e];for(let e of t){let t=l.length,r=l.length-1e3;for(let i=l.length-1;i>=0&&i>=r;i--){let r=0>n(l[i],e);if(!r)break;t=i}l.splice(t,0,e)}return l}(e.data,n[r],o.compare)}))},a=e=>{u(t=>({...t,isLoading:!1,isRetrying:!1,error:e.reason}))},c=()=>{},d=()=>{u({data:[],error:null,isLoading:!0,isRetrying:!1});let o=(0,i.createClient)({url:s.Q.graphQLV2Subscription()});n=o.subscribe({query:(0,r.print)(e),variables:t},{next:l,error:a,complete:c})};return d(),()=>n()},[o.enabled,...null!==(n=o.deps)&&void 0!==n?n:[]]),m}}}]);